var app=function(){"use strict";function t(){}function e(t){return t()}function r(){return Object.create(null)}function n(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t,e){t.appendChild(e)}function a(t,e,r){t.insertBefore(e,r||null)}function u(t){t.parentNode.removeChild(t)}function h(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function f(t){return document.createElement(t)}function c(t){return document.createTextNode(t)}function l(){return c(" ")}function p(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function d(t,e,r){null==r?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function g(t,e,r,n){null===r?t.style.removeProperty(e):t.style.setProperty(e,r,n?"important":"")}let y;function m(t){y=t}function b(){if(!y)throw new Error("Function called outside component initialization");return y}function w(){const t=b();return(e,r)=>{const n=t.$$.callbacks[e];if(n){const o=function(t,e,r=!1){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,r,!1,e),n}(e,r);n.slice().forEach((e=>{e.call(t,o)}))}}}const v=[],E=[],x=[],S=[],O=Promise.resolve();let _=!1;function N(t){x.push(t)}const A=new Set;let T=0;function B(){const t=y;do{for(;T<v.length;){const t=v[T];T++,m(t),k(t.$$)}for(m(null),v.length=0,T=0;E.length;)E.pop()();for(let t=0;t<x.length;t+=1){const e=x[t];A.has(e)||(A.add(e),e())}x.length=0}while(v.length);for(;S.length;)S.pop()();_=!1,A.clear(),m(t)}function k(t){if(null!==t.fragment){t.update(),n(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(N)}}const U=new Set;let I;function $(){I={r:0,c:[],p:I}}function j(){I.r||n(I.c),I=I.p}function R(t,e){t&&t.i&&(U.delete(t),t.i(e))}function L(t,e,r,n){if(t&&t.o){if(U.has(t))return;U.add(t),I.c.push((()=>{U.delete(t),n&&(r&&t.d(1),n())})),t.o(e)}}function P(t,r,i,s){const{fragment:a,on_mount:u,on_destroy:h,after_update:f}=t.$$;a&&a.m(r,i),s||N((()=>{const r=u.map(e).filter(o);h?h.push(...r):n(r),t.$$.on_mount=[]})),f.forEach(N)}function C(t,e){const r=t.$$;null!==r.fragment&&(n(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function D(t,e){-1===t.$$.dirty[0]&&(v.push(t),_||(_=!0,O.then(B)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function M(e,o,i,s,a,h,f,c=[-1]){const l=y;m(e);const p=e.$$={fragment:null,ctx:null,props:h,update:t,not_equal:a,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(l?l.$$.context:[])),callbacks:r(),dirty:c,skip_bound:!1,root:o.target||l.$$.root};f&&f(p.root);let d=!1;if(p.ctx=i?i(e,o.props||{},((t,r,...n)=>{const o=n.length?n[0]:r;return p.ctx&&a(p.ctx[t],p.ctx[t]=o)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](o),d&&D(e,t)),r})):[],p.update(),d=!0,n(p.before_update),p.fragment=!!s&&s(p.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);p.fragment&&p.fragment.l(t),t.forEach(u)}else p.fragment&&p.fragment.c();o.intro&&R(e.$$.fragment),P(e,o.target,o.anchor,o.customElement),B()}m(l)}class J{$destroy(){C(this,1),this.$destroy=t}$on(t,e){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(e),()=>{const t=r.indexOf(e);-1!==t&&r.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function V(e){let r,o,i,h,y,m,b,w,v,E,x,S,O,_,N;return{c(){r=f("div"),o=f("div"),i=c(e[1]),h=l(),y=f("div"),m=f("button"),w=l(),v=f("button"),x=l(),S=f("button"),g(o,"--letter-color","var(--color-"+e[0]+")"),d(o,"class","letter svelte-kfznc"),d(m,"class","absent svelte-kfznc"),m.disabled=b=!!e[2],d(v,"class","present svelte-kfznc"),v.disabled=E=!!e[2],d(S,"class","correct svelte-kfznc"),S.disabled=O=!!e[2],d(y,"class","color-selector svelte-kfznc"),d(r,"class","letter-wrapper svelte-kfznc")},m(t,n){a(t,r,n),s(r,o),s(o,i),s(r,h),s(r,y),s(y,m),s(y,w),s(y,v),s(y,x),s(y,S),_||(N=[p(m,"click",e[4]),p(v,"click",e[5]),p(S,"click",e[6])],_=!0)},p(t,[e]){2&e&&function(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}(i,t[1]),1&e&&g(o,"--letter-color","var(--color-"+t[0]+")"),4&e&&b!==(b=!!t[2])&&(m.disabled=b),4&e&&E!==(E=!!t[2])&&(v.disabled=E),4&e&&O!==(O=!!t[2])&&(S.disabled=O)},i:t,o:t,d(t){t&&u(r),_=!1,n(N)}}}function F(t,e,r){let{color:n,letter:o,frozen:i}=e;const s=w();function a(t){r(0,n=t),s("colorchange",{color:t})}return t.$$set=t=>{"color"in t&&r(0,n=t.color),"letter"in t&&r(1,o=t.letter),"frozen"in t&&r(2,i=t.frozen)},[n,o,i,a,()=>a("absent"),()=>a("present"),()=>a("correct")]}class W extends J{constructor(t){super(),M(this,t,F,V,i,{color:0,letter:1,frozen:2})}}class q{static COLOR={absent:0,present:1,correct:2,undefined:-1};static AGG_WITH_REGEX=t=>[{$search:{index:"wordle_dictionary",regex:{query:t,path:"word",allowAnalyzedField:!0}}},{$sample:{size:1}}];static BASE_AGG=[{$sample:{size:1}}];constructor(){this.schema=[]}agg(){if(0===this.schema.length)return q.BASE_AGG;const t=[{in:"",out:""},{in:"",out:""},{in:"",out:""},{in:"",out:""},{in:"",out:""}],e=[];for(let r=0;r<5;r++)for(const n of this.schema)switch(n[r].color){case q.COLOR.absent:t.forEach((t=>{t.out+=n[r].letter}));break;case q.COLOR.present:t[r].out+=n[r].letter,e.push(n[r].letter);break;case q.COLOR.correct:t[r].in=n[r].letter}let r="";return e.length>0&&(r+=e.map((t=>`.*${t}.*`)).join("&"),r+="&"),r+=t.map((t=>t.in?t.in:`[^${t.out}]`)).join(""),q.AGG_WITH_REGEX(r)}pushRow(t){this.schema.push(t)}}for(var H=function(t){var e=et(t),r=e[0],n=e[1];return 3*(r+n)/4-n},z=function(t){var e,r,n=et(t),o=n[0],i=n[1],s=new K(function(t,e,r){return 3*(e+r)/4-r}(0,o,i)),a=0,u=i>0?o-4:o;for(r=0;r<u;r+=4)e=Y[t.charCodeAt(r)]<<18|Y[t.charCodeAt(r+1)]<<12|Y[t.charCodeAt(r+2)]<<6|Y[t.charCodeAt(r+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;2===i&&(e=Y[t.charCodeAt(r)]<<2|Y[t.charCodeAt(r+1)]>>4,s[a++]=255&e);1===i&&(e=Y[t.charCodeAt(r)]<<10|Y[t.charCodeAt(r+1)]<<4|Y[t.charCodeAt(r+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e);return s},Z=function(t){for(var e,r=t.length,n=r%3,o=[],i=16383,s=0,a=r-n;s<a;s+=i)o.push(rt(t,s,s+i>a?a:s+i));1===n?(e=t[r-1],o.push(G[e>>2]+G[e<<4&63]+"==")):2===n&&(e=(t[r-2]<<8)+t[r-1],o.push(G[e>>10]+G[e>>4&63]+G[e<<2&63]+"="));return o.join("")},G=[],Y=[],K="undefined"!=typeof Uint8Array?Uint8Array:Array,X="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Q=0,tt=X.length;Q<tt;++Q)G[Q]=X[Q],Y[X.charCodeAt(Q)]=Q;function et(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function rt(t,e,r){for(var n,o,i=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),i.push(G[(o=n)>>18&63]+G[o>>12&63]+G[o>>6&63]+G[63&o]);return i.join("")}Y["-".charCodeAt(0)]=62,Y["_".charCodeAt(0)]=63;var nt,ot,it={byteLength:H,toByteArray:z,fromByteArray:Z},st=function(t,e,r,n,o){var i,s,a=8*o-n-1,u=(1<<a)-1,h=u>>1,f=-7,c=r?o-1:0,l=r?-1:1,p=t[e+c];for(c+=l,i=p&(1<<-f)-1,p>>=-f,f+=a;f>0;i=256*i+t[e+c],c+=l,f-=8);for(s=i&(1<<-f)-1,i>>=-f,f+=n;f>0;s=256*s+t[e+c],c+=l,f-=8);if(0===i)i=1-h;else{if(i===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),i-=h}return(p?-1:1)*s*Math.pow(2,i-n)},at=function(t,e,r,n,o,i){var s,a,u,h=8*i-o-1,f=(1<<h)-1,c=f>>1,l=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,d=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+c>=1?l/u:l*Math.pow(2,1-c))*u>=2&&(s++,u/=2),s+c>=f?(a=0,s=f):s+c>=1?(a=(e*u-1)*Math.pow(2,o),s+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,o),s=0));o>=8;t[r+p]=255&a,p+=d,a/=256,o-=8);for(s=s<<o|a,h+=o;h>0;t[r+p]=255&s,p+=d,s/=256,h-=8);t[r+p-d]|=128*g},ut=(nt=function(t,e){var r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=i,e.SlowBuffer=function(t){return+t!=t&&(t=0),i.alloc(+t)},e.INSPECT_MAX_BYTES=50;var n=2147483647;function o(t){if(t>n)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,i.prototype),e}function i(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return s(t,e,r)}function s(t,e,r){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!i.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|l(t,e),n=o(r),s=n.write(t,e);return s!==r&&(n=n.slice(0,s)),n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(C(t,Uint8Array)){var e=new Uint8Array(t);return f(e.buffer,e.byteOffset,e.byteLength)}return h(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(t));if(C(t,ArrayBuffer)||t&&C(t.buffer,ArrayBuffer))return f(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(C(t,SharedArrayBuffer)||t&&C(t.buffer,SharedArrayBuffer)))return f(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return i.from(n,e,r);var s=function(t){if(i.isBuffer(t)){var e=0|c(t.length),r=o(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!=typeof t.length||D(t.length)?o(0):h(t):"Buffer"===t.type&&Array.isArray(t.data)?h(t.data):void 0}(t);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return i.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(t))}function a(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return a(t),o(t<0?0:0|c(t))}function h(t){for(var e=t.length<0?0:0|c(t.length),r=o(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function f(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,i.prototype),n}function c(t){if(t>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|t}function l(t,e){if(i.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||C(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+babelHelpers.typeof(t));var r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var o=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return R(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return L(t).length;default:if(o)return n?-1:R(t).length;e=(""+e).toLowerCase(),o=!0}}function p(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return A(this,e,r);case"utf8":case"utf-8":return S(this,e,r);case"ascii":return _(this,e,r);case"latin1":case"binary":return N(this,e,r);case"base64":return x(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function d(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function g(t,e,r,n,o){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),D(r=+r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof e&&(e=i.from(e,n)),i.isBuffer(e))return 0===e.length?-1:y(t,e,r,n,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):y(t,[e],r,n,o);throw new TypeError("val must be string, number or Buffer")}function y(t,e,r,n,o){var i,s=1,a=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,r/=2}function h(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){var f=-1;for(i=r;i<a;i++)if(h(t,i)===h(e,-1===f?0:i-f)){if(-1===f&&(f=i),i-f+1===u)return f*s}else-1!==f&&(i-=i-f),f=-1}else for(r+u>a&&(r=a-u),i=r;i>=0;i--){for(var c=!0,l=0;l<u;l++)if(h(t,i+l)!==h(e,l)){c=!1;break}if(c)return i}return-1}function m(t,e,r,n){r=Number(r)||0;var o=t.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=e.length;n>i/2&&(n=i/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if(D(a))return s;t[r+s]=a}return s}function b(t,e,r,n){return P(R(e,t.length-r),t,r,n)}function w(t,e,r,n){return P(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function v(t,e,r,n){return P(L(e),t,r,n)}function E(t,e,r,n){return P(function(t,e){for(var r,n,o,i=[],s=0;s<t.length&&!((e-=2)<0);++s)n=(r=t.charCodeAt(s))>>8,o=r%256,i.push(o),i.push(n);return i}(e,t.length-r),t,r,n)}function x(t,e,r){return 0===e&&r===t.length?it.fromByteArray(t):it.fromByteArray(t.slice(e,r))}function S(t,e,r){r=Math.min(t.length,r);for(var n=[],o=e;o<r;){var i,s,a,u,h=t[o],f=null,c=h>239?4:h>223?3:h>191?2:1;if(o+c<=r)switch(c){case 1:h<128&&(f=h);break;case 2:128==(192&(i=t[o+1]))&&(u=(31&h)<<6|63&i)>127&&(f=u);break;case 3:i=t[o+1],s=t[o+2],128==(192&i)&&128==(192&s)&&(u=(15&h)<<12|(63&i)<<6|63&s)>2047&&(u<55296||u>57343)&&(f=u);break;case 4:i=t[o+1],s=t[o+2],a=t[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(u=(15&h)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(f=u)}null===f?(f=65533,c=1):f>65535&&(f-=65536,n.push(f>>>10&1023|55296),f=56320|1023&f),n.push(f),o+=c}return function(t){var e=t.length;if(e<=O)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=O));return r}(n)}e.kMaxLength=n,i.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),i.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.buffer}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.byteOffset}}),i.poolSize=8192,i.from=function(t,e,r){return s(t,e,r)},Object.setPrototypeOf(i.prototype,Uint8Array.prototype),Object.setPrototypeOf(i,Uint8Array),i.alloc=function(t,e,r){return function(t,e,r){return a(t),t<=0?o(t):void 0!==e?"string"==typeof r?o(t).fill(e,r):o(t).fill(e):o(t)}(t,e,r)},i.allocUnsafe=function(t){return u(t)},i.allocUnsafeSlow=function(t){return u(t)},i.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==i.prototype},i.compare=function(t,e){if(C(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),C(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),!i.isBuffer(t)||!i.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,n=e.length,o=0,s=Math.min(r,n);o<s;++o)if(t[o]!==e[o]){r=t[o],n=e[o];break}return r<n?-1:n<r?1:0},i.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return i.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=i.allocUnsafe(e),o=0;for(r=0;r<t.length;++r){var s=t[r];if(C(s,Uint8Array))o+s.length>n.length?i.from(s).copy(n,o):Uint8Array.prototype.set.call(n,s,o);else{if(!i.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,o)}o+=s.length}return n},i.byteLength=l,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)d(this,e,e+1);return this},i.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)d(this,e,e+3),d(this,e+1,e+2);return this},i.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)d(this,e,e+7),d(this,e+1,e+6),d(this,e+2,e+5),d(this,e+3,e+4);return this},i.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?S(this,0,t):p.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(t){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===i.compare(this,t)},i.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},r&&(i.prototype[r]=i.prototype.inspect),i.prototype.compare=function(t,e,r,n,o){if(C(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),!i.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+babelHelpers.typeof(t));if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),e<0||r>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&e>=r)return 0;if(n>=o)return-1;if(e>=r)return 1;if(this===t)return 0;for(var s=(o>>>=0)-(n>>>=0),a=(r>>>=0)-(e>>>=0),u=Math.min(s,a),h=this.slice(n,o),f=t.slice(e,r),c=0;c<u;++c)if(h[c]!==f[c]){s=h[c],a=f[c];break}return s<a?-1:a<s?1:0},i.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},i.prototype.indexOf=function(t,e,r){return g(this,t,e,r,!0)},i.prototype.lastIndexOf=function(t,e,r){return g(this,t,e,r,!1)},i.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-e;if((void 0===r||r>o)&&(r=o),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return m(this,t,e,r);case"utf8":case"utf-8":return b(this,t,e,r);case"ascii":case"latin1":case"binary":return w(this,t,e,r);case"base64":return v(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var O=4096;function _(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(127&t[o]);return n}function N(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(t[o]);return n}function A(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=e;i<r;++i)o+=M[t[i]];return o}function T(t,e,r){for(var n=t.slice(e,r),o="",i=0;i<n.length-1;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function B(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function k(t,e,r,n,o,s){if(!i.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function U(t,e,r,n,o,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function I(t,e,r,n,o){return e=+e,r>>>=0,o||U(t,0,r,4),at(t,e,r,n,23,4),r+4}function $(t,e,r,n,o){return e=+e,r>>>=0,o||U(t,0,r,8),at(t,e,r,n,52,8),r+8}i.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,i.prototype),n},i.prototype.readUintLE=i.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||B(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n},i.prototype.readUintBE=i.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||B(t,e,this.length);for(var n=this[t+--e],o=1;e>0&&(o*=256);)n+=this[t+--e]*o;return n},i.prototype.readUint8=i.prototype.readUInt8=function(t,e){return t>>>=0,e||B(t,1,this.length),this[t]},i.prototype.readUint16LE=i.prototype.readUInt16LE=function(t,e){return t>>>=0,e||B(t,2,this.length),this[t]|this[t+1]<<8},i.prototype.readUint16BE=i.prototype.readUInt16BE=function(t,e){return t>>>=0,e||B(t,2,this.length),this[t]<<8|this[t+1]},i.prototype.readUint32LE=i.prototype.readUInt32LE=function(t,e){return t>>>=0,e||B(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},i.prototype.readUint32BE=i.prototype.readUInt32BE=function(t,e){return t>>>=0,e||B(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},i.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||B(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*e)),n},i.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||B(t,e,this.length);for(var n=e,o=1,i=this[t+--n];n>0&&(o*=256);)i+=this[t+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},i.prototype.readInt8=function(t,e){return t>>>=0,e||B(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},i.prototype.readInt16LE=function(t,e){t>>>=0,e||B(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt16BE=function(t,e){t>>>=0,e||B(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt32LE=function(t,e){return t>>>=0,e||B(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},i.prototype.readInt32BE=function(t,e){return t>>>=0,e||B(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},i.prototype.readFloatLE=function(t,e){return t>>>=0,e||B(t,4,this.length),st(this,t,!0,23,4)},i.prototype.readFloatBE=function(t,e){return t>>>=0,e||B(t,4,this.length),st(this,t,!1,23,4)},i.prototype.readDoubleLE=function(t,e){return t>>>=0,e||B(t,8,this.length),st(this,t,!0,52,8)},i.prototype.readDoubleBE=function(t,e){return t>>>=0,e||B(t,8,this.length),st(this,t,!1,52,8)},i.prototype.writeUintLE=i.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||k(this,t,e,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[e]=255&t;++i<r&&(o*=256);)this[e+i]=t/o&255;return e+r},i.prototype.writeUintBE=i.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||k(this,t,e,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+r},i.prototype.writeUint8=i.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,1,255,0),this[e]=255&t,e+1},i.prototype.writeUint16LE=i.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},i.prototype.writeUint16BE=i.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},i.prototype.writeUint32LE=i.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},i.prototype.writeUint32BE=i.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},i.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var o=Math.pow(2,8*r-1);k(this,t,e,r,o-1,-o)}var i=0,s=1,a=0;for(this[e]=255&t;++i<r&&(s*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+r},i.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var o=Math.pow(2,8*r-1);k(this,t,e,r,o-1,-o)}var i=r-1,s=1,a=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+r},i.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},i.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},i.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},i.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},i.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},i.prototype.writeFloatLE=function(t,e,r){return I(this,t,e,!0,r)},i.prototype.writeFloatBE=function(t,e,r){return I(this,t,e,!1,r)},i.prototype.writeDoubleLE=function(t,e,r){return $(this,t,e,!0,r)},i.prototype.writeDoubleBE=function(t,e,r){return $(this,t,e,!1,r)},i.prototype.copy=function(t,e,r,n){if(!i.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var o=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),o},i.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!i.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var o=t.charCodeAt(0);("utf8"===n&&o<128||"latin1"===n)&&(t=o)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var a=i.isBuffer(t)?t:i.from(t,n),u=a.length;if(0===u)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<r-e;++s)this[s+e]=a[s%u]}return this};var j=/[^+/0-9A-Za-z-_]/g;function R(t,e){var r;e=e||1/0;for(var n=t.length,o=null,i=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!o){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function L(t){return it.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(j,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function P(t,e,r,n){for(var o=0;o<n&&!(o+r>=e.length||o>=t.length);++o)e[o+r]=t[o];return o}function C(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function D(t){return t!=t}var M=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=16*r,o=0;o<16;++o)e[n+o]=t[r]+t[o];return e}()},nt(ot={exports:{}},ot.exports),ot.exports),ht=ut.Buffer;
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ut.SlowBuffer,ut.INSPECT_MAX_BYTES,ut.kMaxLength;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var ft=function(t,e){return ft=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},ft(t,e)};function ct(t,e){function r(){this.constructor=t}ft(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var lt=function(t){function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return ct(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"BSONError"},enumerable:!1,configurable:!0}),e}(Error),pt=function(t){function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return ct(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"BSONTypeError"},enumerable:!1,configurable:!0}),e}(TypeError);function dt(t){return t&&t.Math==Math&&t}function gt(){return dt("object"==typeof globalThis&&globalThis)||dt("object"==typeof window&&window)||dt("object"==typeof self&&self)||dt("object"==typeof global&&global)||Function("return this")()}var yt=function(t){var e,r="object"==typeof(e=gt()).navigator&&"ReactNative"===e.navigator.product?"BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.":"BSON: No cryptographic implementation for random bytes present, falling back to a less secure implementation.";console.warn(r);for(var n=ht.alloc(t),o=0;o<t;++o)n[o]=Math.floor(256*Math.random());return n},mt=function(){if("undefined"!=typeof window){var t=window.crypto||window.msCrypto;if(t&&t.getRandomValues)return function(e){return t.getRandomValues(ht.alloc(e))}}if("undefined"!=typeof global&&global.crypto&&global.crypto.getRandomValues)return function(t){return global.crypto.getRandomValues(ht.alloc(t))};var e;try{e=require("crypto").randomBytes}catch(t){}return e||yt}();function bt(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)}function wt(t){return"object"==typeof t&&null!==t}function vt(t,e){var r=!1;return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return r||(console.warn(e),r=!0),t.apply(this,n)}}function Et(t){if(ArrayBuffer.isView(t))return ht.from(t.buffer,t.byteOffset,t.byteLength);if(e=t,["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(e)))return ht.from(t);var e;throw new pt("Must use either Buffer or TypedArray")}var xt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{12}4[0-9a-f]{3}[89ab][0-9a-f]{15})$/i,St=function(t){return"string"==typeof t&&xt.test(t)},Ot=function(t){if(!St(t))throw new pt('UUID string representations must be a 32 or 36 character hex string (dashes excluded/included). Format: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" or "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".');var e=t.replace(/-/g,"");return ht.from(e,"hex")},_t=function(t,e){return void 0===e&&(e=!0),e?t.toString("hex",0,4)+"-"+t.toString("hex",4,6)+"-"+t.toString("hex",6,8)+"-"+t.toString("hex",8,10)+"-"+t.toString("hex",10,16):t.toString("hex")},Nt=Symbol("id"),At=function(){function t(e){if(void 0===e)this.id=t.generate();else if(e instanceof t)this[Nt]=ht.from(e.id),this.__id=e.__id;else if(ArrayBuffer.isView(e)&&16===e.byteLength)this.id=Et(e);else{if("string"!=typeof e)throw new pt("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");this.id=Ot(e)}}return Object.defineProperty(t.prototype,"id",{get:function(){return this[Nt]},set:function(e){this[Nt]=e,t.cacheHexString&&(this.__id=_t(e))},enumerable:!1,configurable:!0}),t.prototype.toHexString=function(e){if(void 0===e&&(e=!0),t.cacheHexString&&this.__id)return this.__id;var r=_t(this.id,e);return t.cacheHexString&&(this.__id=r),r},t.prototype.toString=function(t){return t?this.id.toString(t):this.toHexString()},t.prototype.toJSON=function(){return this.toHexString()},t.prototype.equals=function(e){if(!e)return!1;if(e instanceof t)return e.id.equals(this.id);try{return new t(e).id.equals(this.id)}catch(t){return!1}},t.prototype.toBinary=function(){return new Tt(this.id,Tt.SUBTYPE_UUID)},t.generate=function(){var t=mt(16);return t[6]=15&t[6]|64,t[8]=63&t[8]|128,ht.from(t)},t.isValid=function(e){if(!e)return!1;if(e instanceof t)return!0;if("string"==typeof e)return St(e);if(bt(e)){if(16!==e.length)return!1;try{return parseInt(e[6].toString(16)[0],10)===Tt.SUBTYPE_UUID}catch(t){return!1}}return!1},t.createFromHexString=function(e){return new t(Ot(e))},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new UUID("'+this.toHexString()+'")'},t}();Object.defineProperty(At.prototype,"_bsontype",{value:"UUID"});var Tt=function(){function t(e,r){if(!(this instanceof t))return new t(e,r);if(!(null==e||"string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||Array.isArray(e)))throw new pt("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>");this.sub_type=null!=r?r:t.BSON_BINARY_SUBTYPE_DEFAULT,null==e?(this.buffer=ht.alloc(t.BUFFER_SIZE),this.position=0):("string"==typeof e?this.buffer=ht.from(e,"binary"):Array.isArray(e)?this.buffer=ht.from(e):this.buffer=Et(e),this.position=this.buffer.byteLength)}return t.prototype.put=function(e){if("string"==typeof e&&1!==e.length)throw new pt("only accepts single character String");if("number"!=typeof e&&1!==e.length)throw new pt("only accepts single character Uint8Array or Array");var r;if((r="string"==typeof e?e.charCodeAt(0):"number"==typeof e?e:e[0])<0||r>255)throw new pt("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.length>this.position)this.buffer[this.position++]=r;else{var n=ht.alloc(t.BUFFER_SIZE+this.buffer.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n,this.buffer[this.position++]=r}},t.prototype.write=function(t,e){if(e="number"==typeof e?e:this.position,this.buffer.length<e+t.length){var r=ht.alloc(this.buffer.length+t.length);this.buffer.copy(r,0,0,this.buffer.length),this.buffer=r}ArrayBuffer.isView(t)?(this.buffer.set(Et(t),e),this.position=e+t.byteLength>this.position?e+t.length:this.position):"string"==typeof t&&(this.buffer.write(t,e,t.length,"binary"),this.position=e+t.length>this.position?e+t.length:this.position)},t.prototype.read=function(t,e){return e=e&&e>0?e:this.position,this.buffer.slice(t,t+e)},t.prototype.value=function(t){return(t=!!t)&&this.buffer.length===this.position?this.buffer:t?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position)},t.prototype.length=function(){return this.position},t.prototype.toJSON=function(){return this.buffer.toString("base64")},t.prototype.toString=function(t){return this.buffer.toString(t)},t.prototype.toExtendedJSON=function(t){t=t||{};var e=this.buffer.toString("base64"),r=Number(this.sub_type).toString(16);return t.legacy?{$binary:e,$type:1===r.length?"0"+r:r}:{$binary:{base64:e,subType:1===r.length?"0"+r:r}}},t.prototype.toUUID=function(){if(this.sub_type===t.SUBTYPE_UUID)return new At(this.buffer.slice(0,this.position));throw new lt('Binary sub_type "'+this.sub_type+'" is not supported for converting to UUID. Only "'+t.SUBTYPE_UUID+'" is currently supported.')},t.fromExtendedJSON=function(e,r){var n,o;if(r=r||{},"$binary"in e?r.legacy&&"string"==typeof e.$binary&&"$type"in e?(o=e.$type?parseInt(e.$type,16):0,n=ht.from(e.$binary,"base64")):"string"!=typeof e.$binary&&(o=e.$binary.subType?parseInt(e.$binary.subType,16):0,n=ht.from(e.$binary.base64,"base64")):"$uuid"in e&&(o=4,n=Ot(e.$uuid)),!n)throw new pt("Unexpected Binary Extended JSON format "+JSON.stringify(e));return new t(n,o)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new Binary(Buffer.from("'+this.value(!0).toString("hex")+'", "hex"), '+this.sub_type+")"},t.BSON_BINARY_SUBTYPE_DEFAULT=0,t.BUFFER_SIZE=256,t.SUBTYPE_DEFAULT=0,t.SUBTYPE_FUNCTION=1,t.SUBTYPE_BYTE_ARRAY=2,t.SUBTYPE_UUID_OLD=3,t.SUBTYPE_UUID=4,t.SUBTYPE_MD5=5,t.SUBTYPE_ENCRYPTED=6,t.SUBTYPE_COLUMN=7,t.SUBTYPE_USER_DEFINED=128,t}();Object.defineProperty(Tt.prototype,"_bsontype",{value:"Binary"});var Bt=function(){function t(e,r){if(!(this instanceof t))return new t(e,r);this.code=e,this.scope=r}return t.prototype.toJSON=function(){return{code:this.code,scope:this.scope}},t.prototype.toExtendedJSON=function(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}},t.fromExtendedJSON=function(e){return new t(e.$code,e.$scope)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){var t=this.toJSON();return'new Code("'+t.code+'"'+(t.scope?", "+JSON.stringify(t.scope):"")+")"},t}();Object.defineProperty(Bt.prototype,"_bsontype",{value:"Code"});var kt=function(){function t(e,r,n,o){if(!(this instanceof t))return new t(e,r,n,o);var i=e.split(".");2===i.length&&(n=i.shift(),e=i.shift()),this.collection=e,this.oid=r,this.db=n,this.fields=o||{}}return Object.defineProperty(t.prototype,"namespace",{get:function(){return this.collection},set:function(t){this.collection=t},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){var t=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return null!=this.db&&(t.$db=this.db),t},t.prototype.toExtendedJSON=function(t){t=t||{};var e={$ref:this.collection,$id:this.oid};return t.legacy?e:(this.db&&(e.$db=this.db),e=Object.assign(e,this.fields))},t.fromExtendedJSON=function(e){var r=Object.assign({},e);return delete r.$ref,delete r.$id,delete r.$db,new t(e.$ref,e.$id,e.$db,r)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){var t=void 0===this.oid||void 0===this.oid.toString?this.oid:this.oid.toString();return'new DBRef("'+this.namespace+'", new ObjectId("'+t+'")'+(this.db?', "'+this.db+'"':"")+")"},t}();Object.defineProperty(kt.prototype,"_bsontype",{value:"DBRef"});var Ut=void 0;try{Ut=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}var It=4294967296,$t=0x10000000000000000,jt=$t/2,Rt={},Lt={},Pt=function(){function t(e,r,n){if(void 0===e&&(e=0),!(this instanceof t))return new t(e,r,n);"bigint"==typeof e?Object.assign(this,t.fromBigInt(e,!!r)):"string"==typeof e?Object.assign(this,t.fromString(e,!!r)):(this.low=0|e,this.high=0|r,this.unsigned=!!n),Object.defineProperty(this,"__isLong__",{value:!0,configurable:!1,writable:!1,enumerable:!1})}return t.fromBits=function(e,r,n){return new t(e,r,n)},t.fromInt=function(e,r){var n,o,i;return r?(i=0<=(e>>>=0)&&e<256)&&(o=Lt[e])?o:(n=t.fromBits(e,(0|e)<0?-1:0,!0),i&&(Lt[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(o=Rt[e])?o:(n=t.fromBits(e,e<0?-1:0,!1),i&&(Rt[e]=n),n)},t.fromNumber=function(e,r){if(isNaN(e))return r?t.UZERO:t.ZERO;if(r){if(e<0)return t.UZERO;if(e>=$t)return t.MAX_UNSIGNED_VALUE}else{if(e<=-jt)return t.MIN_VALUE;if(e+1>=jt)return t.MAX_VALUE}return e<0?t.fromNumber(-e,r).neg():t.fromBits(e%It|0,e/It|0,r)},t.fromBigInt=function(e,r){return t.fromString(e.toString(),r)},t.fromString=function(e,r,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t.ZERO;if("number"==typeof r?(n=r,r=!1):r=!!r,(n=n||10)<2||36<n)throw RangeError("radix");var o;if((o=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===o)return t.fromString(e.substring(1),r,n).neg();for(var i=t.fromNumber(Math.pow(n,8)),s=t.ZERO,a=0;a<e.length;a+=8){var u=Math.min(8,e.length-a),h=parseInt(e.substring(a,a+u),n);if(u<8){var f=t.fromNumber(Math.pow(n,u));s=s.mul(f).add(t.fromNumber(h))}else s=(s=s.mul(i)).add(t.fromNumber(h))}return s.unsigned=r,s},t.fromBytes=function(e,r,n){return n?t.fromBytesLE(e,r):t.fromBytesBE(e,r)},t.fromBytesLE=function(e,r){return new t(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,r)},t.fromBytesBE=function(e,r){return new t(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],r)},t.isLong=function(t){return wt(t)&&!0===t.__isLong__},t.fromValue=function(e,r){return"number"==typeof e?t.fromNumber(e,r):"string"==typeof e?t.fromString(e,r):t.fromBits(e.low,e.high,"boolean"==typeof r?r:e.unsigned)},t.prototype.add=function(e){t.isLong(e)||(e=t.fromValue(e));var r=this.high>>>16,n=65535&this.high,o=this.low>>>16,i=65535&this.low,s=e.high>>>16,a=65535&e.high,u=e.low>>>16,h=0,f=0,c=0,l=0;return c+=(l+=i+(65535&e.low))>>>16,l&=65535,f+=(c+=o+u)>>>16,c&=65535,h+=(f+=n+a)>>>16,f&=65535,h+=r+s,h&=65535,t.fromBits(c<<16|l,h<<16|f,this.unsigned)},t.prototype.and=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low&e.low,this.high&e.high,this.unsigned)},t.prototype.compare=function(e){if(t.isLong(e)||(e=t.fromValue(e)),this.eq(e))return 0;var r=this.isNegative(),n=e.isNegative();return r&&!n?-1:!r&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},t.prototype.comp=function(t){return this.compare(t)},t.prototype.divide=function(e){if(t.isLong(e)||(e=t.fromValue(e)),e.isZero())throw Error("division by zero");if(Ut){if(!this.unsigned&&-2147483648===this.high&&-1===e.low&&-1===e.high)return this;var r=(this.unsigned?Ut.div_u:Ut.div_s)(this.low,this.high,e.low,e.high);return t.fromBits(r,Ut.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?t.UZERO:t.ZERO;var n,o,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return t.UZERO;if(e.gt(this.shru(1)))return t.UONE;i=t.UZERO}else{if(this.eq(t.MIN_VALUE))return e.eq(t.ONE)||e.eq(t.NEG_ONE)?t.MIN_VALUE:e.eq(t.MIN_VALUE)?t.ONE:(n=this.shr(1).div(e).shl(1)).eq(t.ZERO)?e.isNegative()?t.ONE:t.NEG_ONE:(o=this.sub(e.mul(n)),i=n.add(o.div(e)));if(e.eq(t.MIN_VALUE))return this.unsigned?t.UZERO:t.ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=t.ZERO}for(o=this;o.gte(e);){n=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),a=s<=48?1:Math.pow(2,s-48),u=t.fromNumber(n),h=u.mul(e);h.isNegative()||h.gt(o);)n-=a,h=(u=t.fromNumber(n,this.unsigned)).mul(e);u.isZero()&&(u=t.ONE),i=i.add(u),o=o.sub(h)}return i},t.prototype.div=function(t){return this.divide(t)},t.prototype.equals=function(e){return t.isLong(e)||(e=t.fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},t.prototype.eq=function(t){return this.equals(t)},t.prototype.getHighBits=function(){return this.high},t.prototype.getHighBitsUnsigned=function(){return this.high>>>0},t.prototype.getLowBits=function(){return this.low},t.prototype.getLowBitsUnsigned=function(){return this.low>>>0},t.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(t.MIN_VALUE)?64:this.neg().getNumBitsAbs();var e,r=0!==this.high?this.high:this.low;for(e=31;e>0&&0==(r&1<<e);e--);return 0!==this.high?e+33:e+1},t.prototype.greaterThan=function(t){return this.comp(t)>0},t.prototype.gt=function(t){return this.greaterThan(t)},t.prototype.greaterThanOrEqual=function(t){return this.comp(t)>=0},t.prototype.gte=function(t){return this.greaterThanOrEqual(t)},t.prototype.ge=function(t){return this.greaterThanOrEqual(t)},t.prototype.isEven=function(){return 0==(1&this.low)},t.prototype.isNegative=function(){return!this.unsigned&&this.high<0},t.prototype.isOdd=function(){return 1==(1&this.low)},t.prototype.isPositive=function(){return this.unsigned||this.high>=0},t.prototype.isZero=function(){return 0===this.high&&0===this.low},t.prototype.lessThan=function(t){return this.comp(t)<0},t.prototype.lt=function(t){return this.lessThan(t)},t.prototype.lessThanOrEqual=function(t){return this.comp(t)<=0},t.prototype.lte=function(t){return this.lessThanOrEqual(t)},t.prototype.modulo=function(e){if(t.isLong(e)||(e=t.fromValue(e)),Ut){var r=(this.unsigned?Ut.rem_u:Ut.rem_s)(this.low,this.high,e.low,e.high);return t.fromBits(r,Ut.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))},t.prototype.mod=function(t){return this.modulo(t)},t.prototype.rem=function(t){return this.modulo(t)},t.prototype.multiply=function(e){if(this.isZero())return t.ZERO;if(t.isLong(e)||(e=t.fromValue(e)),Ut){var r=Ut.mul(this.low,this.high,e.low,e.high);return t.fromBits(r,Ut.get_high(),this.unsigned)}if(e.isZero())return t.ZERO;if(this.eq(t.MIN_VALUE))return e.isOdd()?t.MIN_VALUE:t.ZERO;if(e.eq(t.MIN_VALUE))return this.isOdd()?t.MIN_VALUE:t.ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(t.TWO_PWR_24)&&e.lt(t.TWO_PWR_24))return t.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,o=65535&this.high,i=this.low>>>16,s=65535&this.low,a=e.high>>>16,u=65535&e.high,h=e.low>>>16,f=65535&e.low,c=0,l=0,p=0,d=0;return p+=(d+=s*f)>>>16,d&=65535,l+=(p+=i*f)>>>16,p&=65535,l+=(p+=s*h)>>>16,p&=65535,c+=(l+=o*f)>>>16,l&=65535,c+=(l+=i*h)>>>16,l&=65535,c+=(l+=s*u)>>>16,l&=65535,c+=n*f+o*h+i*u+s*a,c&=65535,t.fromBits(p<<16|d,c<<16|l,this.unsigned)},t.prototype.mul=function(t){return this.multiply(t)},t.prototype.negate=function(){return!this.unsigned&&this.eq(t.MIN_VALUE)?t.MIN_VALUE:this.not().add(t.ONE)},t.prototype.neg=function(){return this.negate()},t.prototype.not=function(){return t.fromBits(~this.low,~this.high,this.unsigned)},t.prototype.notEquals=function(t){return!this.equals(t)},t.prototype.neq=function(t){return this.notEquals(t)},t.prototype.ne=function(t){return this.notEquals(t)},t.prototype.or=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low|e.low,this.high|e.high,this.unsigned)},t.prototype.shiftLeft=function(e){return t.isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?t.fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):t.fromBits(0,this.low<<e-32,this.unsigned)},t.prototype.shl=function(t){return this.shiftLeft(t)},t.prototype.shiftRight=function(e){return t.isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?t.fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):t.fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},t.prototype.shr=function(t){return this.shiftRight(t)},t.prototype.shiftRightUnsigned=function(e){if(t.isLong(e)&&(e=e.toInt()),0===(e&=63))return this;var r=this.high;if(e<32){var n=this.low;return t.fromBits(n>>>e|r<<32-e,r>>>e,this.unsigned)}return 32===e?t.fromBits(r,0,this.unsigned):t.fromBits(r>>>e-32,0,this.unsigned)},t.prototype.shr_u=function(t){return this.shiftRightUnsigned(t)},t.prototype.shru=function(t){return this.shiftRightUnsigned(t)},t.prototype.subtract=function(e){return t.isLong(e)||(e=t.fromValue(e)),this.add(e.neg())},t.prototype.sub=function(t){return this.subtract(t)},t.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},t.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*It+(this.low>>>0):this.high*It+(this.low>>>0)},t.prototype.toBigInt=function(){return BigInt(this.toString())},t.prototype.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},t.prototype.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},t.prototype.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},t.prototype.toSigned=function(){return this.unsigned?t.fromBits(this.low,this.high,!1):this},t.prototype.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(t.MIN_VALUE)){var r=t.fromNumber(e),n=this.div(r),o=n.mul(r).sub(this);return n.toString(e)+o.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=t.fromNumber(Math.pow(e,6),this.unsigned),s=this,a="";;){var u=s.div(i),h=(s.sub(u.mul(i)).toInt()>>>0).toString(e);if((s=u).isZero())return h+a;for(;h.length<6;)h="0"+h;a=""+h+a}},t.prototype.toUnsigned=function(){return this.unsigned?this:t.fromBits(this.low,this.high,!0)},t.prototype.xor=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low^e.low,this.high^e.high,this.unsigned)},t.prototype.eqz=function(){return this.isZero()},t.prototype.le=function(t){return this.lessThanOrEqual(t)},t.prototype.toExtendedJSON=function(t){return t&&t.relaxed?this.toNumber():{$numberLong:this.toString()}},t.fromExtendedJSON=function(e,r){var n=t.fromString(e.$numberLong);return r&&r.relaxed?n.toNumber():n},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new Long("'+this.toString()+'"'+(this.unsigned?", true":"")+")"},t.TWO_PWR_24=t.fromInt(16777216),t.MAX_UNSIGNED_VALUE=t.fromBits(-1,-1,!0),t.ZERO=t.fromInt(0),t.UZERO=t.fromInt(0,!0),t.ONE=t.fromInt(1),t.UONE=t.fromInt(1,!0),t.NEG_ONE=t.fromInt(-1),t.MAX_VALUE=t.fromBits(-1,2147483647,!1),t.MIN_VALUE=t.fromBits(0,-2147483648,!1),t}();Object.defineProperty(Pt.prototype,"__isLong__",{value:!0}),Object.defineProperty(Pt.prototype,"_bsontype",{value:"Long"});var Ct=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,Dt=/^(\+|-)?(Infinity|inf)$/i,Mt=/^(\+|-)?NaN$/i,Jt=6111,Vt=-6176,Ft=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),Wt=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),qt=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),Ht=/^([-+])?(\d+)?$/;function zt(t){return!isNaN(parseInt(t,10))}function Zt(t){var e=Pt.fromNumber(1e9),r=Pt.fromNumber(0);if(!(t.parts[0]||t.parts[1]||t.parts[2]||t.parts[3]))return{quotient:t,rem:r};for(var n=0;n<=3;n++)r=(r=r.shiftLeft(32)).add(new Pt(t.parts[n],0)),t.parts[n]=r.div(e).low,r=r.modulo(e);return{quotient:t,rem:r}}function Gt(t,e){throw new pt('"'+t+'" is not a valid Decimal128 string - '+e)}var Yt=function(){function t(e){if(!(this instanceof t))return new t(e);if("string"==typeof e)this.bytes=t.fromString(e).bytes;else{if(!bt(e))throw new pt("Decimal128 must take a Buffer or string");if(16!==e.byteLength)throw new pt("Decimal128 must take a Buffer of 16 bytes");this.bytes=e}}return t.fromString=function(e){var r,n=!1,o=!1,i=!1,s=0,a=0,u=0,h=0,f=0,c=[0],l=0,p=0,d=0,g=0,y=0,m=0,b=new Pt(0,0),w=new Pt(0,0),v=0;if(e.length>=7e3)throw new pt(e+" not a valid Decimal128 string");var E=e.match(Ct),x=e.match(Dt),S=e.match(Mt);if(!E&&!x&&!S||0===e.length)throw new pt(e+" not a valid Decimal128 string");if(E){var O=E[2],_=E[4],N=E[5],A=E[6];_&&void 0===A&&Gt(e,"missing exponent power"),_&&void 0===O&&Gt(e,"missing exponent base"),void 0===_&&(N||A)&&Gt(e,"missing e before exponent")}if("+"!==e[v]&&"-"!==e[v]||(n="-"===e[v++]),!zt(e[v])&&"."!==e[v]){if("i"===e[v]||"I"===e[v])return new t(ht.from(n?Wt:qt));if("N"===e[v])return new t(ht.from(Ft))}for(;zt(e[v])||"."===e[v];)"."!==e[v]?(l<34&&("0"!==e[v]||i)&&(i||(f=a),i=!0,c[p++]=parseInt(e[v],10),l+=1),i&&(u+=1),o&&(h+=1),a+=1,v+=1):(o&&Gt(e,"contains multiple periods"),o=!0,v+=1);if(o&&!a)throw new pt(e+" not a valid Decimal128 string");if("e"===e[v]||"E"===e[v]){var T=e.substr(++v).match(Ht);if(!T||!T[2])return new t(ht.from(Ft));y=parseInt(T[0],10),v+=T[0].length}if(e[v])return new t(ht.from(Ft));if(d=0,l){if(g=l-1,1!==(s=u))for(;0===c[f+s-1];)s-=1}else d=0,g=0,c[0]=0,u=1,l=1,s=0;for(y<=h&&h-y>16384?y=Vt:y-=h;y>Jt;){if((g+=1)-d>34){if(c.join("").match(/^0+$/)){y=Jt;break}Gt(e,"overflow")}y-=1}for(;y<Vt||l<u;){if(0===g&&s<l){y=Vt,s=0;break}if(l<u?u-=1:g-=1,y<Jt)y+=1;else{if(c.join("").match(/^0+$/)){y=Jt;break}Gt(e,"overflow")}}if(g-d+1<s){var B=a;o&&(f+=1,B+=1),n&&(f+=1,B+=1);var k=parseInt(e[f+g+1],10),U=0;if(k>=5&&(U=1,5===k))for(U=c[g]%2==1?1:0,m=f+g+2;m<B;m++)if(parseInt(e[m],10)){U=1;break}if(U)for(var I=g;I>=0;I--)if(++c[I]>9&&(c[I]=0,0===I)){if(!(y<Jt))return new t(ht.from(n?Wt:qt));y+=1,c[I]=1}}if(b=Pt.fromNumber(0),w=Pt.fromNumber(0),0===s)b=Pt.fromNumber(0),w=Pt.fromNumber(0);else if(g-d<17){I=d;for(w=Pt.fromNumber(c[I++]),b=new Pt(0,0);I<=g;I++)w=(w=w.multiply(Pt.fromNumber(10))).add(Pt.fromNumber(c[I]))}else{I=d;for(b=Pt.fromNumber(c[I++]);I<=g-17;I++)b=(b=b.multiply(Pt.fromNumber(10))).add(Pt.fromNumber(c[I]));for(w=Pt.fromNumber(c[I++]);I<=g;I++)w=(w=w.multiply(Pt.fromNumber(10))).add(Pt.fromNumber(c[I]))}var $,j,R,L,P=function(t,e){if(!t&&!e)return{high:Pt.fromNumber(0),low:Pt.fromNumber(0)};var r=t.shiftRightUnsigned(32),n=new Pt(t.getLowBits(),0),o=e.shiftRightUnsigned(32),i=new Pt(e.getLowBits(),0),s=r.multiply(o),a=r.multiply(i),u=n.multiply(o),h=n.multiply(i);return s=s.add(a.shiftRightUnsigned(32)),a=new Pt(a.getLowBits(),0).add(u).add(h.shiftRightUnsigned(32)),{high:s=s.add(a.shiftRightUnsigned(32)),low:h=a.shiftLeft(32).add(new Pt(h.getLowBits(),0))}}(b,Pt.fromString("100000000000000000"));P.low=P.low.add(w),$=P.low,j=w,R=$.high>>>0,L=j.high>>>0,(R<L||R===L&&$.low>>>0<j.low>>>0)&&(P.high=P.high.add(Pt.fromNumber(1))),r=y+6176;var C={low:Pt.fromNumber(0),high:Pt.fromNumber(0)};P.high.shiftRightUnsigned(49).and(Pt.fromNumber(1)).equals(Pt.fromNumber(1))?(C.high=C.high.or(Pt.fromNumber(3).shiftLeft(61)),C.high=C.high.or(Pt.fromNumber(r).and(Pt.fromNumber(16383).shiftLeft(47))),C.high=C.high.or(P.high.and(Pt.fromNumber(0x7fffffffffff)))):(C.high=C.high.or(Pt.fromNumber(16383&r).shiftLeft(49)),C.high=C.high.or(P.high.and(Pt.fromNumber(562949953421311)))),C.low=P.low,n&&(C.high=C.high.or(Pt.fromString("9223372036854775808")));var D=ht.alloc(16);return v=0,D[v++]=255&C.low.low,D[v++]=C.low.low>>8&255,D[v++]=C.low.low>>16&255,D[v++]=C.low.low>>24&255,D[v++]=255&C.low.high,D[v++]=C.low.high>>8&255,D[v++]=C.low.high>>16&255,D[v++]=C.low.high>>24&255,D[v++]=255&C.high.low,D[v++]=C.high.low>>8&255,D[v++]=C.high.low>>16&255,D[v++]=C.high.low>>24&255,D[v++]=255&C.high.high,D[v++]=C.high.high>>8&255,D[v++]=C.high.high>>16&255,D[v++]=C.high.high>>24&255,new t(D)},t.prototype.toString=function(){for(var t,e=0,r=new Array(36),n=0;n<r.length;n++)r[n]=0;var o,i,s,a=0,u=!1,h={parts:[0,0,0,0]},f=[];a=0;var c=this.bytes,l=c[a++]|c[a++]<<8|c[a++]<<16|c[a++]<<24,p=c[a++]|c[a++]<<8|c[a++]<<16|c[a++]<<24,d=c[a++]|c[a++]<<8|c[a++]<<16|c[a++]<<24,g=c[a++]|c[a++]<<8|c[a++]<<16|c[a++]<<24;a=0,{low:new Pt(l,p),high:new Pt(d,g)}.high.lessThan(Pt.ZERO)&&f.push("-");var y=g>>26&31;if(y>>3==3){if(30===y)return f.join("")+"Infinity";if(31===y)return"NaN";t=g>>15&16383,o=8+(g>>14&1)}else o=g>>14&7,t=g>>17&16383;var m=t-6176;if(h.parts[0]=(16383&g)+((15&o)<<14),h.parts[1]=d,h.parts[2]=p,h.parts[3]=l,0===h.parts[0]&&0===h.parts[1]&&0===h.parts[2]&&0===h.parts[3])u=!0;else for(s=3;s>=0;s--){var b=0,w=Zt(h);if(h=w.quotient,b=w.rem.low)for(i=8;i>=0;i--)r[9*s+i]=b%10,b=Math.floor(b/10)}if(u)e=1,r[a]=0;else for(e=36;!r[a];)e-=1,a+=1;var v=e-1+m;if(v>=34||v<=-7||m>0){if(e>34)return f.push("0"),m>0?f.push("E+"+m):m<0&&f.push("E"+m),f.join("");f.push(""+r[a++]),(e-=1)&&f.push(".");for(n=0;n<e;n++)f.push(""+r[a++]);f.push("E"),v>0?f.push("+"+v):f.push(""+v)}else if(m>=0)for(n=0;n<e;n++)f.push(""+r[a++]);else{var E=e+m;if(E>0)for(n=0;n<E;n++)f.push(""+r[a++]);else f.push("0");for(f.push(".");E++<0;)f.push("0");for(n=0;n<e-Math.max(E-1,0);n++)f.push(""+r[a++])}return f.join("")},t.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},t.prototype.toExtendedJSON=function(){return{$numberDecimal:this.toString()}},t.fromExtendedJSON=function(e){return t.fromString(e.$numberDecimal)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new Decimal128("'+this.toString()+'")'},t}();Object.defineProperty(Yt.prototype,"_bsontype",{value:"Decimal128"});var Kt=function(){function t(e){if(!(this instanceof t))return new t(e);e instanceof Number&&(e=e.valueOf()),this.value=+e}return t.prototype.valueOf=function(){return this.value},t.prototype.toJSON=function(){return this.value},t.prototype.toString=function(t){return this.value.toString(t)},t.prototype.toExtendedJSON=function(t){return t&&(t.legacy||t.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-"+this.value.toFixed(1)}:(Number.isInteger(this.value)?(e=this.value.toFixed(1)).length>=13&&(e=this.value.toExponential(13).toUpperCase()):e=this.value.toString(),{$numberDouble:e});var e},t.fromExtendedJSON=function(e,r){var n=parseFloat(e.$numberDouble);return r&&r.relaxed?n:new t(n)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new Double("+this.toExtendedJSON().$numberDouble+")"},t}();Object.defineProperty(Kt.prototype,"_bsontype",{value:"Double"});var Xt=function(){function t(e){if(!(this instanceof t))return new t(e);e instanceof Number&&(e=e.valueOf()),this.value=0|+e}return t.prototype.valueOf=function(){return this.value},t.prototype.toString=function(t){return this.value.toString(t)},t.prototype.toJSON=function(){return this.value},t.prototype.toExtendedJSON=function(t){return t&&(t.relaxed||t.legacy)?this.value:{$numberInt:this.value.toString()}},t.fromExtendedJSON=function(e,r){return r&&r.relaxed?parseInt(e.$numberInt,10):new t(e.$numberInt)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new Int32("+this.valueOf()+")"},t}();Object.defineProperty(Xt.prototype,"_bsontype",{value:"Int32"});var Qt=function(){function t(){if(!(this instanceof t))return new t}return t.prototype.toExtendedJSON=function(){return{$maxKey:1}},t.fromExtendedJSON=function(){return new t},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new MaxKey()"},t}();Object.defineProperty(Qt.prototype,"_bsontype",{value:"MaxKey"});var te=function(){function t(){if(!(this instanceof t))return new t}return t.prototype.toExtendedJSON=function(){return{$minKey:1}},t.fromExtendedJSON=function(){return new t},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new MinKey()"},t}();Object.defineProperty(te.prototype,"_bsontype",{value:"MinKey"});var ee=new RegExp("^[0-9a-fA-F]{24}$"),re=null,ne=Symbol("id"),oe=function(){function t(e){if(!(this instanceof t))return new t(e);var r;if("object"==typeof e&&e&&"id"in e){if("string"!=typeof e.id&&!ArrayBuffer.isView(e.id))throw new pt("Argument passed in must have an id that is of type string or Buffer");r="toHexString"in e&&"function"==typeof e.toHexString?ht.from(e.toHexString(),"hex"):e.id}else r=e;if(null==r||"number"==typeof r)this[ne]=t.generate("number"==typeof r?r:void 0);else if(ArrayBuffer.isView(r)&&12===r.byteLength)this[ne]=Et(r);else{if("string"!=typeof r)throw new pt("Argument passed in does not match the accepted types");if(12===r.length){var n=ht.from(r);if(12!==n.byteLength)throw new pt("Argument passed in must be a string of 12 bytes");this[ne]=n}else{if(24!==r.length||!ee.test(r))throw new pt("Argument passed in must be a string of 12 bytes or a string of 24 hex characters");this[ne]=ht.from(r,"hex")}}t.cacheHexString&&(this.__id=this.id.toString("hex"))}return Object.defineProperty(t.prototype,"id",{get:function(){return this[ne]},set:function(e){this[ne]=e,t.cacheHexString&&(this.__id=e.toString("hex"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"generationTime",{get:function(){return this.id.readInt32BE(0)},set:function(t){this.id.writeUInt32BE(t,0)},enumerable:!1,configurable:!0}),t.prototype.toHexString=function(){if(t.cacheHexString&&this.__id)return this.__id;var e=this.id.toString("hex");return t.cacheHexString&&!this.__id&&(this.__id=e),e},t.getInc=function(){return t.index=(t.index+1)%16777215},t.generate=function(e){"number"!=typeof e&&(e=Math.floor(Date.now()/1e3));var r=t.getInc(),n=ht.alloc(12);return n.writeUInt32BE(e,0),null===re&&(re=mt(5)),n[4]=re[0],n[5]=re[1],n[6]=re[2],n[7]=re[3],n[8]=re[4],n[11]=255&r,n[10]=r>>8&255,n[9]=r>>16&255,n},t.prototype.toString=function(t){return t?this.id.toString(t):this.toHexString()},t.prototype.toJSON=function(){return this.toHexString()},t.prototype.equals=function(e){return null!=e&&(e instanceof t?this.toString()===e.toString():"string"==typeof e&&t.isValid(e)&&12===e.length&&bt(this.id)?e===ht.prototype.toString.call(this.id,"latin1"):"string"==typeof e&&t.isValid(e)&&24===e.length?e.toLowerCase()===this.toHexString():"string"==typeof e&&t.isValid(e)&&12===e.length?ht.from(e).equals(this.id):"object"==typeof e&&"toHexString"in e&&"function"==typeof e.toHexString&&e.toHexString()===this.toHexString())},t.prototype.getTimestamp=function(){var t=new Date,e=this.id.readUInt32BE(0);return t.setTime(1e3*Math.floor(e)),t},t.createPk=function(){return new t},t.createFromTime=function(e){var r=ht.from([0,0,0,0,0,0,0,0,0,0,0,0]);return r.writeUInt32BE(e,0),new t(r)},t.createFromHexString=function(e){if(void 0===e||null!=e&&24!==e.length)throw new pt("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");return new t(ht.from(e,"hex"))},t.isValid=function(e){if(null==e)return!1;try{return new t(e),!0}catch(t){return!1}},t.prototype.toExtendedJSON=function(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}},t.fromExtendedJSON=function(e){return new t(e.$oid)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new ObjectId("'+this.toHexString()+'")'},t.index=Math.floor(16777215*Math.random()),t}();Object.defineProperty(oe.prototype,"generate",{value:vt((function(t){return oe.generate(t)}),"Please use the static `ObjectId.generate(time)` instead")}),Object.defineProperty(oe.prototype,"getInc",{value:vt((function(){return oe.getInc()}),"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(oe.prototype,"get_inc",{value:vt((function(){return oe.getInc()}),"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(oe,"get_inc",{value:vt((function(){return oe.getInc()}),"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(oe.prototype,"_bsontype",{value:"ObjectID"});var ie=function(){function t(e,r){if(!(this instanceof t))return new t(e,r);if(this.pattern=e,this.options=(null!=r?r:"").split("").sort().join(""),-1!==this.pattern.indexOf("\0"))throw new lt("BSON Regex patterns cannot contain null bytes, found: "+JSON.stringify(this.pattern));if(-1!==this.options.indexOf("\0"))throw new lt("BSON Regex options cannot contain null bytes, found: "+JSON.stringify(this.options));for(var n=0;n<this.options.length;n++)if("i"!==this.options[n]&&"m"!==this.options[n]&&"x"!==this.options[n]&&"l"!==this.options[n]&&"s"!==this.options[n]&&"u"!==this.options[n])throw new lt("The regular expression option ["+this.options[n]+"] is not supported")}return t.parseOptions=function(t){return t?t.split("").sort().join(""):""},t.prototype.toExtendedJSON=function(t){return(t=t||{}).legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}},t.fromExtendedJSON=function(e){if("$regex"in e){if("string"==typeof e.$regex)return new t(e.$regex,t.parseOptions(e.$options));if("BSONRegExp"===e.$regex._bsontype)return e}if("$regularExpression"in e)return new t(e.$regularExpression.pattern,t.parseOptions(e.$regularExpression.options));throw new pt("Unexpected BSONRegExp EJSON object form: "+JSON.stringify(e))},t}();Object.defineProperty(ie.prototype,"_bsontype",{value:"BSONRegExp"});var se=function(){function t(e){if(!(this instanceof t))return new t(e);this.value=e}return t.prototype.valueOf=function(){return this.value},t.prototype.toString=function(){return this.value},t.prototype.inspect=function(){return'new BSONSymbol("'+this.value+'")'},t.prototype.toJSON=function(){return this.value},t.prototype.toExtendedJSON=function(){return{$symbol:this.value}},t.fromExtendedJSON=function(e){return new t(e.$symbol)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t}();Object.defineProperty(se.prototype,"_bsontype",{value:"Symbol"});var ae=function(t){function e(r,n){var o=this;return o instanceof e?(o=Pt.isLong(r)?t.call(this,r.low,r.high,!0)||this:wt(r)&&void 0!==r.t&&void 0!==r.i?t.call(this,r.i,r.t,!0)||this:t.call(this,r,n,!0)||this,Object.defineProperty(o,"_bsontype",{value:"Timestamp",writable:!1,configurable:!1,enumerable:!1}),o):new e(r,n)}return ct(e,t),e.prototype.toJSON=function(){return{$timestamp:this.toString()}},e.fromInt=function(t){return new e(Pt.fromInt(t,!0))},e.fromNumber=function(t){return new e(Pt.fromNumber(t,!0))},e.fromBits=function(t,r){return new e(t,r)},e.fromString=function(t,r){return new e(Pt.fromString(t,!0,r))},e.prototype.toExtendedJSON=function(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}},e.fromExtendedJSON=function(t){return new e(t.$timestamp)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new Timestamp({ t: "+this.getHighBits()+", i: "+this.getLowBits()+" })"},e.MAX_VALUE=Pt.MAX_UNSIGNED_VALUE,e}(Pt);var ue=2147483647,he=-2147483648,fe=0x8000000000000000,ce=-0x8000000000000000,le={$oid:oe,$binary:Tt,$uuid:Tt,$symbol:se,$numberInt:Xt,$numberDecimal:Yt,$numberDouble:Kt,$numberLong:Pt,$minKey:te,$maxKey:Qt,$regex:ie,$regularExpression:ie,$timestamp:ae};function pe(t,e){if(void 0===e&&(e={}),"number"==typeof t){if(e.relaxed||e.legacy)return t;if(Math.floor(t)===t){if(t>=he&&t<=ue)return new Xt(t);if(t>=ce&&t<=fe)return Pt.fromNumber(t)}return new Kt(t)}if(null==t||"object"!=typeof t)return t;if(t.$undefined)return null;for(var r=Object.keys(t).filter((function(e){return e.startsWith("$")&&null!=t[e]})),n=0;n<r.length;n++){var o=le[r[n]];if(o)return o.fromExtendedJSON(t,e)}if(null!=t.$date){var i=t.$date,s=new Date;return e.legacy?"number"==typeof i?s.setTime(i):"string"==typeof i&&s.setTime(Date.parse(i)):"string"==typeof i?s.setTime(Date.parse(i)):Pt.isLong(i)?s.setTime(i.toNumber()):"number"==typeof i&&e.relaxed&&s.setTime(i),s}if(null!=t.$code){var a=Object.assign({},t);return t.$scope&&(a.$scope=pe(t.$scope)),Bt.fromExtendedJSON(t)}if(function(t){return wt(t)&&null!=t.$id&&"string"==typeof t.$ref&&(null==t.$db||"string"==typeof t.$db)}(t)||t.$dbPointer){var u=t.$ref?t:t.$dbPointer;if(u instanceof kt)return u;var h=Object.keys(u).filter((function(t){return t.startsWith("$")})),f=!0;if(h.forEach((function(t){-1===["$ref","$id","$db"].indexOf(t)&&(f=!1)})),f)return kt.fromExtendedJSON(u)}return t}function de(t){var e=t.toISOString();return 0!==t.getUTCMilliseconds()?e:e.slice(0,-5)+"Z"}function ge(t,e){if(("object"==typeof t||"function"==typeof t)&&null!==t){var r=e.seenObjects.findIndex((function(e){return e.obj===t}));if(-1!==r){var n=e.seenObjects.map((function(t){return t.propertyName})),o=n.slice(0,r).map((function(t){return t+" -> "})).join(""),i=n[r],s=" -> "+n.slice(r+1,n.length-1).map((function(t){return t+" -> "})).join(""),a=n[n.length-1],u=" ".repeat(o.length+i.length/2),h="-".repeat(s.length+(i.length+a.length)/2-1);throw new pt("Converting circular structure to EJSON:\n    "+o+i+s+a+"\n    "+u+"\\"+h+"/")}e.seenObjects[e.seenObjects.length-1].obj=t}if(Array.isArray(t))return function(t,e){return t.map((function(t,r){e.seenObjects.push({propertyName:"index "+r,obj:null});try{return ge(t,e)}finally{e.seenObjects.pop()}}))}(t,e);if(void 0===t)return null;if(t instanceof Date||wt(l=t)&&"[object Date]"===Object.prototype.toString.call(l)){var f=t.getTime(),c=f>-1&&f<2534023188e5;return e.legacy?e.relaxed&&c?{$date:t.getTime()}:{$date:de(t)}:e.relaxed&&c?{$date:de(t)}:{$date:{$numberLong:t.getTime().toString()}}}var l;if(!("number"!=typeof t||e.relaxed&&isFinite(t))){if(Math.floor(t)===t){var p=t>=ce&&t<=fe;if(t>=he&&t<=ue)return{$numberInt:t.toString()};if(p)return{$numberLong:t.toString()}}return{$numberDouble:t.toString()}}if(t instanceof RegExp||function(t){return"[object RegExp]"===Object.prototype.toString.call(t)}(t)){var d=t.flags;if(void 0===d){var g=t.toString().match(/[gimuy]*$/);g&&(d=g[0])}return new ie(t.source,d).toExtendedJSON(e)}return null!=t&&"object"==typeof t?function(t,e){if(null==t||"object"!=typeof t)throw new lt("not an object instance");var r=t._bsontype;if(void 0===r){var n={};for(var o in t){e.seenObjects.push({propertyName:o,obj:null});try{n[o]=ge(t[o],e)}finally{e.seenObjects.pop()}}return n}if(function(t){return wt(t)&&Reflect.has(t,"_bsontype")&&"string"==typeof t._bsontype}(t)){var i=t;if("function"!=typeof i.toExtendedJSON){var s=me[t._bsontype];if(!s)throw new pt("Unrecognized or invalid _bsontype: "+t._bsontype);i=s(i)}return"Code"===r&&i.scope?i=new Bt(i.code,ge(i.scope,e)):"DBRef"===r&&i.oid&&(i=new kt(ge(i.collection,e),ge(i.oid,e),ge(i.db,e),ge(i.fields,e))),i.toExtendedJSON(e)}throw new lt("_bsontype must be a string, but was: "+typeof r)}(t,e):t}var ye,me={Binary:function(t){return new Tt(t.value(),t.sub_type)},Code:function(t){return new Bt(t.code,t.scope)},DBRef:function(t){return new kt(t.collection||t.namespace,t.oid,t.db,t.fields)},Decimal128:function(t){return new Yt(t.bytes)},Double:function(t){return new Kt(t.value)},Int32:function(t){return new Xt(t.value)},Long:function(t){return Pt.fromBits(null!=t.low?t.low:t.low_,null!=t.low?t.high:t.high_,null!=t.low?t.unsigned:t.unsigned_)},MaxKey:function(){return new Qt},MinKey:function(){return new te},ObjectID:function(t){return new oe(t)},ObjectId:function(t){return new oe(t)},BSONRegExp:function(t){return new ie(t.pattern,t.options)},Symbol:function(t){return new se(t.value)},Timestamp:function(t){return ae.fromBits(t.low,t.high)}};!function(t){function e(t,e){var r=Object.assign({},{relaxed:!0,legacy:!1},e);return"boolean"==typeof r.relaxed&&(r.strict=!r.relaxed),"boolean"==typeof r.strict&&(r.relaxed=!r.strict),JSON.parse(t,(function(t,e){if(-1!==t.indexOf("\0"))throw new lt("BSON Document field names cannot contain null bytes, found: "+JSON.stringify(t));return pe(e,r)}))}function r(t,e,r,n){null!=r&&"object"==typeof r&&(n=r,r=0),null==e||"object"!=typeof e||Array.isArray(e)||(n=e,e=void 0,r=0);var o=ge(t,Object.assign({relaxed:!0,legacy:!1},n,{seenObjects:[{propertyName:"(root)",obj:null}]}));return JSON.stringify(o,e,r)}t.parse=e,t.stringify=r,t.serialize=function(t,e){return e=e||{},JSON.parse(r(t,e))},t.deserialize=function(t,r){return r=r||{},e(JSON.stringify(t),r)}}(ye||(ye={})),gt().Map||function(){function t(t){void 0===t&&(t=[]),this._keys=[],this._values={};for(var e=0;e<t.length;e++)if(null!=t[e]){var r=t[e],n=r[0],o=r[1];this._keys.push(n),this._values[n]={v:o,i:this._keys.length-1}}}t.prototype.clear=function(){this._keys=[],this._values={}},t.prototype.delete=function(t){var e=this._values[t];return null!=e&&(delete this._values[t],this._keys.splice(e.i,1),!0)},t.prototype.entries=function(){var t=this,e=0;return{next:function(){var r=t._keys[e++];return{value:void 0!==r?[r,t._values[r].v]:void 0,done:void 0===r}}}},t.prototype.forEach=function(t,e){e=e||this;for(var r=0;r<this._keys.length;r++){var n=this._keys[r];t.call(e,this._values[n].v,n,e)}},t.prototype.get=function(t){return this._values[t]?this._values[t].v:void 0},t.prototype.has=function(t){return null!=this._values[t]},t.prototype.keys=function(){var t=this,e=0;return{next:function(){var r=t._keys[e++];return{value:void 0!==r?r:void 0,done:void 0===r}}}},t.prototype.set=function(t,e){return this._values[t]?(this._values[t].v=e,this):(this._keys.push(t),this._values[t]={v:e,i:this._keys.length-1},this)},t.prototype.values=function(){var t=this,e=0;return{next:function(){var r=t._keys[e++];return{value:void 0!==r?t._values[r].v:void 0,done:void 0===r}}}},Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!1,configurable:!0})}();var be=Math.pow(2,53),we=-Math.pow(2,53);Pt.fromNumber(be),Pt.fromNumber(we);ht.alloc(17825792);var ve=function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},Ee=function(t,e,r){this.name=t,this.version=e,this.os=r,this.type="browser"},xe=function(t){this.version=t,this.type="node",this.name="node",this.os=process.platform},Se=function(t,e,r,n){this.name=t,this.version=e,this.os=r,this.bot=n,this.type="bot-device"},Oe=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},_e=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},Ne=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ae=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],Te=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Be(t){var e=function(t){return""!==t&&Ae.reduce((function(e,r){var n=r[0],o=r[1];if(e)return e;var i=o.exec(t);return!!i&&[n,i]}),!1)}(t);if(!e)return null;var r=e[0],n=e[1];if("searchbot"===r)return new Oe;var o=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);o?o.length<3&&(o=ve(ve([],o,!0),function(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}(3-o.length),!0)):o=[];var i=o.join("."),s=function(t){for(var e=0,r=Te.length;e<r;e++){var n=Te[e],o=n[0];if(n[1].exec(t))return o}return null}(t),a=Ne.exec(t);return a&&a[1]?new Se(r,i,s,a[1]):new Ee(r,i,s)}class ke{constructor(){if(!ke.fetch)throw new Error("DefaultNetworkTransport.fetch must be set before it's used");if(!ke.AbortController)throw new Error("DefaultNetworkTransport.AbortController must be set before it's used")}fetchWithCallbacks(t,e){this.fetch(t).then((async t=>{const e=await t.text(),r={};return t.headers.forEach(((t,e)=>{r[e]=t})),{statusCode:t.status,headers:r,body:e}})).then((t=>e.onSuccess(t))).catch((t=>e.onError(t)))}async fetch(t){const{timeoutMs:e,url:r,...n}=t,{signal:o,cancelTimeout:i}=this.createTimeoutSignal(e);try{return await ke.fetch(r,{...ke.extraFetchOptions,signal:o,...n})}finally{i()}}createTimeoutSignal(t){if("number"==typeof t){const e=new ke.AbortController,r=setTimeout((()=>{e.abort()}),t);return{signal:e.signal,cancelTimeout:()=>{clearTimeout(r)}}}return{signal:void 0,cancelTimeout:()=>{}}}}ke.DEFAULT_HEADERS={"Content-Type":"application/json"},ke.fetch=globalThis.fetch.bind(globalThis),ke.AbortController=globalThis.AbortController;const Ue="function"==typeof atob,Ie="function"==typeof btoa,$e="function"==typeof Buffer,je="function"==typeof TextDecoder?new TextDecoder:void 0,Re="function"==typeof TextEncoder?new TextEncoder:void 0,Le=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),Pe=(t=>{let e={};return t.forEach(((t,r)=>e[t]=r)),e})(Le),Ce=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,De=String.fromCharCode.bind(String),Me="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):(t,e=(t=>t))=>new Uint8Array(Array.prototype.slice.call(t,0).map(e)),Je=t=>t.replace(/=/g,"").replace(/[+\/]/g,(t=>"+"==t?"-":"_")),Ve=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),Fe=t=>{let e,r,n,o,i="";const s=t.length%3;for(let s=0;s<t.length;){if((r=t.charCodeAt(s++))>255||(n=t.charCodeAt(s++))>255||(o=t.charCodeAt(s++))>255)throw new TypeError("invalid character found");e=r<<16|n<<8|o,i+=Le[e>>18&63]+Le[e>>12&63]+Le[e>>6&63]+Le[63&e]}return s?i.slice(0,s-3)+"===".substring(s):i},We=Ie?t=>btoa(t):$e?t=>Buffer.from(t,"binary").toString("base64"):Fe,qe=$e?t=>Buffer.from(t).toString("base64"):t=>{let e=[];for(let r=0,n=t.length;r<n;r+=4096)e.push(De.apply(null,t.subarray(r,r+4096)));return We(e.join(""))},He=t=>{if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?De(192|e>>>6)+De(128|63&e):De(224|e>>>12&15)+De(128|e>>>6&63)+De(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return De(240|e>>>18&7)+De(128|e>>>12&63)+De(128|e>>>6&63)+De(128|63&e)},ze=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Ze=t=>t.replace(ze,He),Ge=$e?t=>Buffer.from(t,"utf8").toString("base64"):Re?t=>qe(Re.encode(t)):t=>We(Ze(t)),Ye=(t,e=!1)=>e?Je(Ge(t)):Ge(t),Ke=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Xe=t=>{switch(t.length){case 4:var e=((7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3))-65536;return De(55296+(e>>>10))+De(56320+(1023&e));case 3:return De((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return De((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},Qe=t=>t.replace(Ke,Xe),tr=t=>{if(t=t.replace(/\s+/g,""),!Ce.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(3&t.length));let e,r,n,o="";for(let i=0;i<t.length;)e=Pe[t.charAt(i++)]<<18|Pe[t.charAt(i++)]<<12|(r=Pe[t.charAt(i++)])<<6|(n=Pe[t.charAt(i++)]),o+=64===r?De(e>>16&255):64===n?De(e>>16&255,e>>8&255):De(e>>16&255,e>>8&255,255&e);return o},er=Ue?t=>atob(Ve(t)):$e?t=>Buffer.from(t,"base64").toString("binary"):tr,rr=$e?t=>Me(Buffer.from(t,"base64")):t=>Me(er(t),(t=>t.charCodeAt(0))),nr=$e?t=>Buffer.from(t,"base64").toString("utf8"):je?t=>je.decode(rr(t)):t=>Qe(er(t)),or=t=>Ve(t.replace(/[-_]/g,(t=>"-"==t?"+":"/"))),ir=t=>nr(or(t)),sr=Ye,ar=ir,ur={relaxed:!1};function hr(t){return ye.serialize(t,ur)}function fr(t){return Array.isArray(t)?t.map((t=>ye.deserialize(t))):ye.deserialize(t)}var cr,lr;!function(t){t.Normal="normal",t.Server="server"}(cr||(cr={})),function(t){t.NAME="name",t.EMAIL="email",t.PICTURE="picture",t.FIRST_NAME="first_name",t.LAST_NAME="last_name",t.GENDER="gender",t.BIRTHDAY="birthday",t.MIN_AGE="min_age",t.MAX_AGE="max_age"}(lr||(lr={}));const pr={[lr.NAME]:"name",[lr.EMAIL]:"email",[lr.PICTURE]:"pictureUrl",[lr.FIRST_NAME]:"firstName",[lr.LAST_NAME]:"lastName",[lr.GENDER]:"gender",[lr.BIRTHDAY]:"birthday",[lr.MIN_AGE]:"minAge",[lr.MAX_AGE]:"maxAge"};class dr{constructor(t){if(this.type=cr.Normal,this.identities=[],"object"==typeof t&&null!==t){const{type:e,identities:r,data:n}=t;if("string"!=typeof e)throw new Error("Expected 'type' in the response body");if(this.type=e,!Array.isArray(r))throw new Error("Expected 'identities' in the response body");if(this.identities=r.map((t=>{const{id:e,provider_type:r}=t;return{id:e,providerType:r}})),"object"!=typeof n||null===n)throw new Error("Expected 'data' in the response body");{const t=Object.fromEntries(Object.entries(n).map((([t,e])=>t in pr?[pr[t],e]:[t,e])));this.data=fr(t)}}else this.data={}}}class gr{constructor(t,e){this.storage=t,this.keyPart=e}get(t){return this.storage.get(this.keyPart+gr.PART_SEPARATOR+t)}set(t,e){return this.storage.set(this.keyPart+gr.PART_SEPARATOR+t,e)}remove(t){return this.storage.remove(this.keyPart+gr.PART_SEPARATOR+t)}prefix(t){return new gr(this,t)}clear(t=""){return this.storage.clear(this.keyPart+gr.PART_SEPARATOR+t)}addListener(t){return this.storage.addListener(t)}removeListener(t){return this.storage.addListener(t)}}gr.PART_SEPARATOR=":";const yr="accessToken",mr="refreshToken",br="profile",wr="providerType";class vr extends gr{constructor(t,e){super(t,`user(${e})`)}get accessToken(){return this.get(yr)}set accessToken(t){null===t?this.remove(yr):this.set(yr,t)}get refreshToken(){return this.get(mr)}set refreshToken(t){null===t?this.remove(mr):this.set(mr,t)}get profile(){const t=this.get(br);if(t){const e=new dr;return Object.assign(e,JSON.parse(t)),e}}set profile(t){t?this.set(br,JSON.stringify(t)):this.remove(br)}get providerType(){const t=this.get(wr);if(t)return t}set providerType(t){t?this.set(wr,t):this.remove(wr)}}function Er(t){return Object.fromEntries(Object.entries(t).filter((t=>void 0!==t[1])))}function xr(t,e=!0){const r=Er(t);return(e&&Object.keys(r).length>0?"?":"")+Object.entries(r).map((([t,e])=>`${t}=${encodeURIComponent(e)}`)).join("&")}const Sr=["inspect","callFunction","callFunctionStreaming",...Object.getOwnPropertyNames(Object.prototype)];function Or(t){const e=function(t){for(const e of t)if("object"==typeof e&&e)for(const[t,r]of Object.entries(e))void 0===r&&delete e[t];return t}(t);return e.map((t=>"object"==typeof t?hr(t):t))}class _r{constructor(t,e={}){this.fetcher=t,this.serviceName=e.serviceName,this.argsTransformation=e.argsTransformation||Or}static create(t,e={}){const r=new _r(t,e);return new Proxy(r,{get(t,e,r){if("string"==typeof e&&-1===Sr.indexOf(e))return t.callFunction.bind(t,e);{const n=Reflect.get(t,e,r);return"function"==typeof n?n.bind(t):n}}})}async callFunction(t,...e){const r={name:t,arguments:this.argsTransformation?this.argsTransformation(e):e};this.serviceName&&(r.service=this.serviceName);const n=this.fetcher.appRoute;return this.fetcher.fetchJSON({method:"POST",path:n.functionsCall().path,body:r})}callFunctionStreaming(t,...e){const r={name:t,arguments:this.argsTransformation?this.argsTransformation(e):e};this.serviceName&&(r.service=this.serviceName);const n=this.fetcher.appRoute,o=xr({baas_request:sr(JSON.stringify(r))});return this.fetcher.fetchStream({method:"GET",path:n.functionsCall().path+o})}}let Nr=!1;const Ar=(t,e,r,n)=>{if("object"!=typeof t[0]){const s=n?", ...args":"";o=`${e}(${r.join(", ")}${s})`,i=`${e}({ ${r.join(", ")} }${s})`,Nr&&console.warn(`Deprecation warning from Realm: ${o} is deprecated and will be removed in a future major release. Consider switching to ${i}.`);return{argsObject:r.reduce(((e,r,n)=>({...e,[r]:t[n]})),{}),restArgs:n?t.slice(r.length):void 0}}var o,i;return{argsObject:t[0],restArgs:n?t.slice(1):void 0}};var Tr;Tr="undefined"!=typeof __DEV__&&__DEV__,Nr=Tr;class Br{constructor(t,e="local-userpass"){this.fetcher=t,this.providerName=e}async registerUser(...t){const{argsObject:e}=Ar(t,"registerUser",["email","password"]),r=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).register().path,body:e})}async confirmUser(...t){const{argsObject:e}=Ar(t,"confirmUser",["token","tokenId"]),r=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).confirm().path,body:e})}async resendConfirmationEmail(...t){const{argsObject:e}=Ar(t,"resendConfirmationEmail",["email"]),r=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).confirmSend().path,body:e})}async retryCustomConfirmation(...t){const{argsObject:e}=Ar(t,"retryCustomConfirmation",["email"]),r=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).confirmCall().path,body:e})}async resetPassword(...t){const{argsObject:e}=Ar(t,"resetPassword",["token","tokenId","password"]),r=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).reset().path,body:e})}async sendResetPasswordEmail(...t){const{argsObject:e}=Ar(t,"sendResetPasswordEmail",["email"]),r=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).resetSend().path,body:e})}async callResetPasswordFunction(...t){const{argsObject:e,restArgs:r}=Ar(t,"callResetPasswordFunction",["email","password"],!0),n=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:n.emailPasswordAuth(this.providerName).resetCall().path,body:{...e,arguments:r}})}}var kr={api:function(){return{path:"/api/client/v2.0",app(t){return{path:this.path+`/app/${t}`,location(){return{path:this.path+"/location"}},authProvider(t){return{path:this.path+`/auth/providers/${t}`,login(){return{path:this.path+"/login"}}}},emailPasswordAuth(t){return{...this.authProvider(t),register(){return{path:this.path+"/register"}},confirm(){return{path:this.path+"/confirm"}},confirmSend(){return{path:this.path+"/confirm/send"}},confirmCall(){return{path:this.path+"/confirm/call"}},reset(){return{path:this.path+"/reset"}},resetSend(){return{path:this.path+"/reset/send"}},resetCall(){return{path:this.path+"/reset/call"}}}},functionsCall(){return{path:this.path+"/functions/call"}}}},auth(){return{path:this.path+"/auth",apiKeys(){return{path:this.path+"/api_keys",key(t){return{path:this.path+`/${t}`,enable(){return{path:this.path+"/enable"}},disable(){return{path:this.path+"/disable"}}}}}},profile(){return{path:this.path+"/profile"}},session(){return{path:this.path+"/session"}}}}}}};class Ur{constructor(t){this.fetcher=t}create(t){return this.fetcher.fetchJSON({method:"POST",body:{name:t},path:kr.api().auth().apiKeys().path,tokenType:"refresh"})}fetch(t){return this.fetcher.fetchJSON({method:"GET",path:kr.api().auth().apiKeys().key(t).path,tokenType:"refresh"})}fetchAll(){return this.fetcher.fetchJSON({method:"GET",tokenType:"refresh",path:kr.api().auth().apiKeys().path})}async delete(t){await this.fetcher.fetchJSON({method:"DELETE",path:kr.api().auth().apiKeys().key(t).path,tokenType:"refresh"})}async enable(t){await this.fetcher.fetchJSON({method:"PUT",path:kr.api().auth().apiKeys().key(t).enable().path,tokenType:"refresh"})}async disable(t){await this.fetcher.fetchJSON({method:"PUT",path:kr.api().auth().apiKeys().key(t).disable().path,tokenType:"refresh"})}}let Ir=null;function $r(){if(Ir)return Ir;throw new Error("Cannot get environment before it's set")}class jr extends Error{constructor({message:t,code:e}){super(t),this.name="WatchError",this.code=e}}var Rr;!function(t){t.NEED_DATA="NEED_DATA",t.HAVE_EVENT="HAVE_EVENT",t.HAVE_ERROR="HAVE_ERROR"}(Rr||(Rr={}));class Lr{constructor(){this._state=Rr.NEED_DATA,this._error=null,this._textDecoder=new($r().TextDecoder),this._buffer="",this._bufferOffset=0,this._eventType="",this._dataBuffer=""}feedBuffer(t){this.assertState(Rr.NEED_DATA),this._buffer+=this._textDecoder.decode(t,{stream:!0}),this.advanceBufferState()}feedLine(t){if(this.assertState(Rr.NEED_DATA),t.endsWith("\n")&&(t=t.substr(0,t.length-1)),t.endsWith("\r")&&(t=t.substr(0,t.length-1)),0===t.length){if(0===this._dataBuffer.length)return void(this._eventType="");this._dataBuffer.endsWith("\n")&&(this._dataBuffer=this._dataBuffer.substr(0,this._dataBuffer.length-1)),this.feedSse({data:this._dataBuffer,eventType:this._eventType}),this._dataBuffer="",this._eventType=""}if(":"===t[0])return;const e=t.indexOf(":"),r=t.substr(0,e);let n=-1===e?"":t.substr(e+1);n.startsWith(" ")&&(n=n.substr(1)),"event"===r?this._eventType=n:"data"===r&&(this._dataBuffer+=n,this._dataBuffer+="\n")}feedSse(t){this.assertState(Rr.NEED_DATA);const e=t.data.indexOf("%");if(-1!==e){let r="",n=0;for(let o=e;-1!==o;o=t.data.indexOf("%",n)){r+=t.data.substr(n,o-n);const e=t.data.substr(o,3);r+="%25"===e?"%":"%0A"===e?"\n":"%0D"===e?"\r":e,n=o+e.length}r+=t.data.substr(n),t.data=r}if(t.eventType&&"message"!==t.eventType){if("error"===t.eventType){this._state=Rr.HAVE_ERROR,this._error=new jr({message:t.data,code:"unknown"});try{const{error_code:e,error:r}=ye.parse(t.data);if("string"!=typeof e)return;if("string"!=typeof r)return;this._error=new jr({message:r,code:e})}catch{return}}}else{try{const e=ye.parse(t.data);if("object"==typeof e)return this._nextEvent=e,void(this._state=Rr.HAVE_EVENT)}catch{}this._state=Rr.HAVE_ERROR,this._error=new jr({message:"server returned malformed event: "+t.data,code:"bad bson parse"})}}get state(){return this._state}nextEvent(){this.assertState(Rr.HAVE_EVENT);const t=this._nextEvent;return this._state=Rr.NEED_DATA,this.advanceBufferState(),t}get error(){return this._error}advanceBufferState(){for(this.assertState(Rr.NEED_DATA);this.state===Rr.NEED_DATA;){if(this._bufferOffset===this._buffer.length)return this._buffer="",void(this._bufferOffset=0);const t=this._buffer.indexOf("\n",this._bufferOffset);if(-1===t)return void(0!==this._bufferOffset&&(this._buffer=this._buffer.substr(this._bufferOffset,this._buffer.length-this._bufferOffset),this._bufferOffset=0));this.feedLine(this._buffer.substr(this._bufferOffset,t-this._bufferOffset)),this._bufferOffset=t+1}}assertState(t){if(this._state!==t)throw Error(`Expected WatchStream to be in state ${t}, but in state ${this._state}`)}}class Pr{constructor(t,e,r,n){this.functions=_r.create(t,{serviceName:e}),this.databaseName=r,this.collectionName=n,this.serviceName=e,this.fetcher=t}find(t={},e={}){return this.functions.find({database:this.databaseName,collection:this.collectionName,query:t,project:e.projection,sort:e.sort,limit:e.limit})}findOne(t={},e={}){return this.functions.findOne({database:this.databaseName,collection:this.collectionName,query:t,project:e.projection,sort:e.sort})}findOneAndUpdate(t={},e,r={}){return this.functions.findOneAndUpdate({database:this.databaseName,collection:this.collectionName,filter:t,update:e,sort:r.sort,projection:r.projection,upsert:r.upsert,returnNewDocument:r.returnNewDocument})}findOneAndReplace(t={},e,r={}){return this.functions.findOneAndReplace({database:this.databaseName,collection:this.collectionName,filter:t,update:e,sort:r.sort,projection:r.projection,upsert:r.upsert,returnNewDocument:r.returnNewDocument})}findOneAndDelete(t={},e={}){return this.functions.findOneAndReplace({database:this.databaseName,collection:this.collectionName,filter:t,sort:e.sort,projection:e.projection})}aggregate(t){return this.functions.aggregate({database:this.databaseName,collection:this.collectionName,pipeline:t})}count(t={},e={}){return this.functions.count({database:this.databaseName,collection:this.collectionName,query:t,limit:e.limit})}insertOne(t){return this.functions.insertOne({database:this.databaseName,collection:this.collectionName,document:t})}insertMany(t){return this.functions.insertMany({database:this.databaseName,collection:this.collectionName,documents:t})}deleteOne(t={}){return this.functions.deleteOne({database:this.databaseName,collection:this.collectionName,query:t})}deleteMany(t={}){return this.functions.deleteMany({database:this.databaseName,collection:this.collectionName,query:t})}updateOne(t,e,r={}){return this.functions.updateOne({database:this.databaseName,collection:this.collectionName,query:t,update:e,upsert:r.upsert,arrayFilters:r.arrayFilters})}updateMany(t,e,r={}){return this.functions.updateMany({database:this.databaseName,collection:this.collectionName,query:t,update:e,upsert:r.upsert,arrayFilters:r.arrayFilters})}async*watch({ids:t,filter:e}={}){const r=await this.functions.callFunctionStreaming("watch",{database:this.databaseName,collection:this.collectionName,ids:t,filter:e}),n=new Lr;for await(const t of r)if(t){for(n.feedBuffer(t);n.state==Rr.HAVE_EVENT;)yield n.nextEvent();if(n.state==Rr.HAVE_ERROR)throw n.error}}}function Cr(t,e,r,n){return new Pr(t,e,r,n)}function Dr(t,e,r){return{collection:Cr.bind(null,t,e,r)}}var Mr,Jr;!function(t){t.Active="active",t.LoggedOut="logged-out",t.Removed="removed"}(Mr||(Mr={})),function(t){t.Normal="normal",t.Server="server"}(Jr||(Jr={}));class Vr{constructor(t){if(this.app=t.app,this.id=t.id,this.storage=new vr(this.app.storage,this.id),"accessToken"in t&&"refreshToken"in t&&"providerType"in t)this._accessToken=t.accessToken,this._refreshToken=t.refreshToken,this.providerType=t.providerType,this.storage.accessToken=t.accessToken,this.storage.refreshToken=t.refreshToken,this.storage.providerType=t.providerType;else{this._accessToken=this.storage.accessToken,this._refreshToken=this.storage.refreshToken;const t=this.storage.providerType;if(this._profile=this.storage.profile,!t)throw new Error("Storage is missing a provider type");this.providerType=t}this.fetcher=this.app.fetcher.clone({userContext:{currentUser:this}}),this.apiKeys=new Ur(this.fetcher),this.functions=_r.create(this.fetcher)}get accessToken(){return this._accessToken}set accessToken(t){this._accessToken=t,this.storage.accessToken=t}get refreshToken(){return this._refreshToken}set refreshToken(t){this._refreshToken=t,this.storage.refreshToken=t}get state(){return this.id in this.app.allUsers?null===this.refreshToken?Mr.LoggedOut:Mr.Active:Mr.Removed}get isLoggedIn(){return this.state===Mr.Active}get customData(){if(this.accessToken){return this.decodeAccessToken().userData}throw new Error("Cannot read custom data without an access token")}get profile(){if(this._profile)return this._profile.data;throw new Error("A profile was never fetched for this user")}get identities(){if(this._profile)return this._profile.identities;throw new Error("A profile was never fetched for this user")}get deviceId(){if(this.accessToken){const t=this.accessToken.split(".")[1];if(t){const e=JSON.parse(ar(t)).baas_device_id;if("string"==typeof e&&"000000000000000000000000"!==e)return e}}return null}async refreshProfile(){const t=await this.fetcher.fetchJSON({method:"GET",path:kr.api().auth().profile().path});this._profile=new dr(t),this.storage.profile=this._profile}async logOut(){try{null!==this._refreshToken&&await this.fetcher.fetchJSON({method:"DELETE",path:kr.api().auth().session().path,tokenType:"refresh"})}finally{this.accessToken=null,this.refreshToken=null}}async linkCredentials(t){const e=await this.app.authenticator.authenticate(t,this);if(this.id!==e.userId){const t=`got user id ${e.userId} expected ${this.id}`;throw new Error(`Link response ment for another user (${t})`)}this.accessToken=e.accessToken,await this.refreshProfile()}async refreshAccessToken(){const t=await this.fetcher.fetchJSON({method:"POST",path:kr.api().auth().session().path,tokenType:"refresh"}),{access_token:e}=t;if("string"!=typeof e)throw new Error("Expected an 'access_token' in the response");this.accessToken=e}async refreshCustomData(){return await this.refreshAccessToken(),this.customData}callFunction(t,...e){return this.functions.callFunction(t,...e)}toJSON(){return{id:this.id,accessToken:this.accessToken,refreshToken:this.refreshToken,profile:this._profile,state:this.state,customData:this.customData}}push(){throw new Error("Not yet implemented")}mongoClient(t){return function(t,e="mongo-db"){return{db:Dr.bind(null,t,e)}}(this.fetcher,t)}decodeAccessToken(){if(this.accessToken){const t=this.accessToken.split(".");if(3!==t.length)throw new Error("Expected an access token with three parts");const e=t[1],r=ar(e),n=JSON.parse(r),{exp:o,iat:i,sub:s,user_data:a={}}=n;if("number"!=typeof o)throw new Error("Failed to decode access token 'exp'");if("number"!=typeof i)throw new Error("Failed to decode access token 'iat'");return{expires:o,issuedAt:i,subject:s,userData:a}}throw new Error("Missing an access token")}}class Fr{constructor(t,e,r){this.providerName=t,this.providerType=e,this.payload=r}static anonymous(){return new Fr("anon-user","anon-user",{})}static userApiKey(t){return new Fr("api-key","api-key",{key:t})}static serverApiKey(t){return new Fr("api-key","api-key",{key:t})}static apiKey(t){return new Fr("api-key","api-key",{key:t})}static emailPassword(t,e){return new Fr("local-userpass","local-userpass",{username:t,password:e})}static function(t){return new Fr("custom-function","custom-function",t)}static jwt(t){return new Fr("custom-token","custom-token",{token:t})}static google(t){return new Fr("oauth2-google","oauth2-google",Fr.derivePayload(t))}static derivePayload(t){if("string"==typeof t){if(t.includes("://"))return this.derivePayload({redirectUrl:t});if(t.startsWith("4/"))return this.derivePayload({authCode:t});if(t.startsWith("ey"))return this.derivePayload({idToken:t});throw new Error(`Unexpected payload: ${t}`)}if(1===Object.keys(t).length){if("authCode"in t||"redirectUrl"in t)return t;if("idToken"in t)return{id_token:t.idToken};throw new Error("Unexpected payload: "+JSON.stringify(t))}throw new Error("Expected only one property in payload, got "+JSON.stringify(t))}static facebook(t){return new Fr("oauth2-facebook","oauth2-facebook",t.includes("://")?{redirectUrl:t}:{accessToken:t})}static apple(t){return new Fr("oauth2-apple","oauth2-apple",t.includes("://")?{redirectUrl:t}:{id_token:t})}}const Wr="userIds",qr="deviceId";class Hr extends gr{constructor(t,e){super(t,`app(${e})`)}getUserIds(){const t=this.get(Wr),e=t?JSON.parse(t):[];if(Array.isArray(e))return[...new Set(e)];throw new Error("Expected the user ids to be an array")}setUserIds(t,e){if(e){const e=this.getUserIds();for(const r of e)-1===t.indexOf(r)&&t.push(r)}this.set(Wr,JSON.stringify(t))}removeUserId(t){const e=this.getUserIds().filter((e=>e!==t));this.setUserIds(e,!1)}getDeviceId(){return this.get(qr)}setDeviceId(t){this.set(qr,t)}}const zr={_stitch_client_app_id:"appId",_baas_client_app_id:"appId",_stitch_ua:"userAuth",_baas_ua:"userAuth",_stitch_link:"link",_baas_link:"link",_stitch_error:"error",_baas_error:"error",_stitch_state:"state",_baas_state:"state"};class Zr{constructor(t,e=$r().openWindow){this.storage=t.prefix("oauth2"),this.openWindow=e}static parseRedirectLocation(t){const e=function(t){const e="?"===t[0]?t.substr(1):t;return Object.fromEntries(e.split("&").filter((t=>t.length>0)).map((t=>t.split("="))).map((([t,e])=>[t,decodeURIComponent(e)])))}(t),r={};for(const[t,n]of Object.entries(zr)){const o=e[t];o&&(r[n]=o)}return r}static handleRedirect(t,e=$r().defaultStorage){const r=Zr.parseRedirectLocation(t),{state:n,error:o}=r;if("string"!=typeof n)throw o?new Error(`Failed to handle OAuth 2.0 redirect: ${o}`):new Error("Failed to handle OAuth 2.0 redirect.");{const t=e.prefix("oauth2");Zr.getStateStorage(t,n).set("result",JSON.stringify(r))}}static decodeAuthInfo(t){const e=(t||"").split("$");if(4===e.length){const[t,r,n,o]=e;return{accessToken:t,refreshToken:r,userId:n,deviceId:o}}throw new Error("Failed to decode 'authInfo' into ids and tokens")}static getStateStorage(t,e){return t.prefix(`state(${e})`)}openWindowAndWaitForRedirect(t,e){const r=Zr.getStateStorage(this.storage,e);return new Promise(((e,n)=>{let o,i=null;const s=()=>{const t=r.get("result");if(t){const n=JSON.parse(t);r.removeListener(s),r.clear();try{i&&(clearInterval(o),i.close())}catch(t){console.warn(`Failed closing redirect window: ${t}`)}finally{e(n)}}};r.addListener(s),i=this.openWindow(t),o=setInterval((()=>{if(i){if(i.closed){clearInterval(o),r.removeListener(s);const t=new Error("Window closed");n(t)}}else clearInterval(o)}),100)}))}generateState(){return function(t,e){let r="";for(let n=0;n<t;n++)r+=e[Math.floor(Math.random()*e.length)];return r}(12,"abcdefghijklmnopqrstuvwxyz")}}const Gr="x-baas-location";class Yr{constructor(t,e,r){this.fetcher=t,this.oauth2=new Zr(e),this.getDeviceInformation=r}async authenticate(t,e){const r=this.getDeviceInformation(),n="object"==typeof e;if(t.providerType.startsWith("oauth2")&&"string"==typeof t.payload.redirectUrl){const o=this.oauth2.generateState(),i=await this.getLogInUrl(t,n,{state:o,redirect:t.payload.redirectUrl,providerRedirectHeader:!!n||void 0,device:n?void 0:r.encode()});if(n){const t=(await this.fetcher.fetch({method:"GET",url:i,tokenType:n?"access":"none",user:e,mode:"cors",credentials:"include"})).headers.get(Gr);if(t)return this.openWindowAndWaitForAuthResponse(t,o);throw new Error("Missing x-baas-location header")}return this.openWindowAndWaitForAuthResponse(i,o)}{const o=await this.getLogInUrl(t,n),i=await this.fetcher.fetchJSON({method:"POST",url:o,body:{...t.payload,options:{device:r.toJSON()}},tokenType:n?"access":"none",user:e}),{user_id:s,access_token:a,refresh_token:u=null,device_id:h}=i;if("string"!=typeof s)throw new Error("Expected a user id in the response");if("string"!=typeof a)throw new Error("Expected an access token in the response");if("string"!=typeof u&&null!==u)throw new Error("Expected refresh token to be a string or null");if("string"!=typeof h)throw new Error("Expected device id to be a string");return{userId:s,accessToken:a,refreshToken:u,deviceId:h}}}async getLogInUrl(t,e=!1,r={}){const n=this.fetcher.appRoute.authProvider(t.providerName).login(),o=xr({link:e?"true":void 0,...r});return await this.fetcher.locationUrl+n.path+o}async openWindowAndWaitForAuthResponse(t,e){const r=await this.oauth2.openWindowAndWaitForRedirect(t,e);return Zr.decodeAuthInfo(r.userAuth)}}class Kr extends Error{constructor(t,e,r,n,o,i,s){const a=n?`status ${r} ${n}`:`status ${r}`;super("string"==typeof o?`Request failed (${t} ${e}): ${o} (${a})`:`Request failed (${t} ${e}): (${a})`),this.method=t,this.url=e,this.statusText=n,this.statusCode=r,this.error=o,this.errorCode=i,this.link=s}static async fromRequestAndResponse(t,e){var r;const{url:n,method:o}=t,{status:i,statusText:s}=e;if(null===(r=e.headers.get("content-type"))||void 0===r?void 0:r.startsWith("application/json")){const t=await e.json();if("object"==typeof t&&t){const{error:e,error_code:r,link:a}=t;return new Kr(o,n,i,s,"string"==typeof e?e:void 0,"string"==typeof r?r:void 0,"string"==typeof a?a:void 0)}}return new Kr(o,n,i,s)}}class Xr{constructor({appId:t,transport:e,userContext:r,locationUrlContext:n}){this.appId=t,this.transport=e,this.userContext=r,this.locationUrlContext=n}static buildAuthorizationHeader(t,e){if(t&&"none"!==e){if("access"===e)return{Authorization:`Bearer ${t.accessToken}`};if("refresh"===e)return{Authorization:`Bearer ${t.refreshToken}`};throw new Error(`Unexpected token type (${e})`)}return{}}static buildBody(t){if(t){if("object"==typeof t&&null!==t)return JSON.stringify(hr(t));if("string"==typeof t)return t;throw console.log("body is",t),new Error("Unexpected type of body")}}static buildJsonHeader(t){return t&&t.length>0?{"Content-Type":"application/json"}:{}}clone(t){return new Xr({appId:this.appId,transport:this.transport,userContext:this.userContext,locationUrlContext:this.locationUrlContext,...t})}async fetch(t){const{path:e,url:r,tokenType:n="access",user:o=this.userContext.currentUser,...i}=t;if("string"==typeof e&&"string"==typeof r)throw new Error("Use of 'url' and 'path' mutually exclusive");if("string"==typeof e){const r=await this.locationUrlContext.locationUrl+e;return this.fetch({...t,path:void 0,url:r})}if("string"==typeof r){const e=await this.transport.fetch({...i,url:r,headers:{...Xr.buildAuthorizationHeader(o,n),...t.headers}});if(e.ok)return e;if(o&&401===e.status&&"access"===n)return await o.refreshAccessToken(),this.fetch({...t,user:o});throw o&&401===e.status&&"refresh"===n&&(o.accessToken=null,o.refreshToken=null),await Kr.fromRequestAndResponse(t,e)}throw new Error("Expected either 'url' or 'path'")}async fetchJSON(t){const{body:e}=t,r=Xr.buildBody(e),n=Xr.buildJsonHeader(r),o=await this.fetch({...t,body:r,headers:{Accept:"application/json",...n,...t.headers}}),i=o.headers.get("content-type");if(null==i?void 0:i.startsWith("application/json")){return fr(await o.json())}if(null===i)return null;throw new Error(`Expected JSON response, got "${i}"`)}async fetchStream(t){const{body:e}=await this.fetch({...t,headers:{Accept:"text/event-stream",...t.headers}});return function(t){if("object"!=typeof t||null===t)throw new Error("Expected a non-null object");if(Symbol.asyncIterator in t)return t;if("getReader"in t){const e=t;return{[Symbol.asyncIterator](){const t=e.getReader();return{next:()=>t.read(),return:async()=>(await t.cancel(),{done:!0,value:null})}}}}throw new Error("Expected an AsyncIterable or a ReadableStream")}(e)}get appRoute(){return kr.api().app(this.appId)}get locationUrl(){return this.locationUrlContext.locationUrl}}var Qr;!function(t){t.DEVICE_ID="deviceId",t.APP_ID="appId",t.APP_VERSION="appVersion",t.PLATFORM="platform",t.PLATFORM_VERSION="platformVersion",t.SDK_VERSION="sdkVersion"}(Qr||(Qr={}));class tn{constructor({appId:t,appVersion:e,deviceId:r}){this.sdkVersion="1.6.0";const n=$r();this.platform=n.platform,this.platformVersion=n.platformVersion,this.appId=t,this.appVersion=e,this.deviceId=r}encode(){const t=Er(this);return sr(JSON.stringify(t))}toJSON(){return Er(this)}}class en{constructor(t){this.users=[],this._locationUrl=null;const e="string"==typeof t?{id:t}:t;if("object"!=typeof e||"string"!=typeof e.id)throw new Error("Missing a MongoDB Realm app-id");this.id=e.id,this.baseUrl=e.baseUrl||"https://stitch.mongodb.com",e.skipLocationRequest&&(this._locationUrl=Promise.resolve(this.baseUrl)),this.localApp=e.app;const{storage:r,transport:n=new ke}=e;this.fetcher=new Xr({appId:this.id,userContext:this,locationUrlContext:this,transport:n}),this.emailPasswordAuth=new Br(this.fetcher);const o=r||$r().defaultStorage;this.storage=new Hr(o,this.id),this.authenticator=new Yr(this.fetcher,o,(()=>this.deviceInformation));try{this.hydrate()}catch(t){this.storage.clear(),console.warn("Realm app hydration failed:",t.message)}}static getApp(t){if(t in en.appCache)return en.appCache[t];{const e=new en(t);return en.appCache[t]=e,e}}switchUser(t){const e=this.users.findIndex((e=>e===t));if(-1===e)throw new Error("The user was never logged into this app");const[r]=this.users.splice(e,1);this.users.unshift(r)}async logIn(t,e=!0){const r=await this.authenticator.authenticate(t),n=this.createOrUpdateUser(r,t.providerType);this.switchUser(n),e&&await n.refreshProfile(),this.storage.setUserIds(this.users.map((t=>t.id)),!0);const o=r.deviceId;return o&&"000000000000000000000000"!==o&&this.storage.set("deviceId",o),n}async removeUser(t){const e=this.users.findIndex((e=>e===t));if(-1===e)throw new Error("The user was never logged into this app");this.users.splice(e,1),await t.logOut(),this.storage.remove(`user(${t.id}):profile`),this.storage.removeUserId(t.id)}get currentUser(){const t=this.users.filter((t=>t.state===Mr.Active));return 0===t.length?null:t[0]}get allUsers(){return Object.fromEntries(this.users.map((t=>[t.id,t])))}get locationUrl(){if(!this._locationUrl){const t=kr.api().app(this.id).location().path;this._locationUrl=this.fetcher.fetchJSON({method:"GET",url:this.baseUrl+t,tokenType:"none"}).then((t=>{if("object"!=typeof t)throw new Error("Expected response body be an object");return t})).then((({hostname:t})=>{if("string"!=typeof t)throw new Error("Expected response to contain a 'hostname'");return t})).catch((t=>{throw this._locationUrl=null,t}))}return this._locationUrl}get deviceInformation(){const t=this.storage.getDeviceId(),e="string"==typeof t&&"000000000000000000000000"!==t?new oe(t):void 0;return new tn({appId:this.localApp?this.localApp.name:void 0,appVersion:this.localApp?this.localApp.version:void 0,deviceId:e})}createOrUpdateUser(t,e){const r=this.users.find((e=>e.id===t.userId));if(r)return r.accessToken=t.accessToken,r.refreshToken=t.refreshToken,r;{if(!t.refreshToken)throw new Error("No refresh token in response from server");const r=new Vr({app:this,id:t.userId,accessToken:t.accessToken,refreshToken:t.refreshToken,providerType:e});return this.users.unshift(r),r}}hydrate(){const t=this.storage.getUserIds();this.users=t.map((t=>new Vr({app:this,id:t})))}}en.appCache={},en.Credentials=Fr;const rn=nn?Be(nn):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new _e:"undefined"!=typeof navigator?Be(navigator.userAgent):"undefined"!=typeof process&&process.version?new xe(process.version.slice(1)):null;var nn;const on="localStorage"in globalThis?class{constructor(){if("object"!=typeof globalThis.localStorage)throw new Error("Cannot use LocalStorage without a global localStorage object");this.global=globalThis}get(t){return this.global.localStorage.getItem(t)}set(t,e){return this.global.localStorage.setItem(t,e)}remove(t){return this.global.localStorage.removeItem(t)}prefix(t){return new gr(this,t)}clear(t){const e=[];for(let r=0;r<this.global.localStorage.length;r++){const n=this.global.localStorage.key(r);!n||t&&!n.startsWith(t)||e.push(n)}for(const t of e)this.global.localStorage.removeItem(t)}addListener(t){return this.global.addEventListener("storage",t)}removeListener(t){return this.global.removeEventListener("storage",t)}}:class{constructor(){this.storage={},this.listeners=new Set}get(t){return t in this.storage?this.storage[t]:null}set(t,e){this.storage[t]=e,this.fireListeners()}remove(t){delete this.storage[t],this.fireListeners()}prefix(t){return new gr(this,t)}clear(t){for(const e of Object.keys(this.storage))t&&!e.startsWith(t)||delete this.storage[e];this.fireListeners()}addListener(t){this.listeners.add(t)}removeListener(t){this.listeners.delete(t)}fireListeners(){this.listeners.forEach((t=>t()))}};const sn={defaultStorage:(new on).prefix("realm-web"),openWindow:function(t){return"function"==typeof globalThis.open?globalThis.open(t):(console.log(`Please open ${t}`),null)},platform:(null==rn?void 0:rn.name)||"web",platformVersion:(null==rn?void 0:rn.version)||"0.0.0",TextDecoder:TextDecoder};function an(t,e,r){const n=t.slice();return n[10]=e[r],n[12]=r,n}function un(t,e,r){const n=t.slice();return n[13]=e[r],n[15]=r,n}function hn(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function fn(t){let e,r,n=t[0],o=[];for(let e=0;e<n.length;e+=1)o[e]=ln(an(t,n,e));const i=t=>L(o[t],1,1,(()=>{o[t]=null}));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=c("")},m(t,n){for(let e=0;e<o.length;e+=1)o[e].m(t,n);a(t,e,n),r=!0},p(t,r){if(15&r){let s;for(n=t[0],s=0;s<n.length;s+=1){const i=an(t,n,s);o[s]?(o[s].p(i,r),R(o[s],1)):(o[s]=ln(i),o[s].c(),R(o[s],1),o[s].m(e.parentNode,e))}for($(),s=n.length;s<o.length;s+=1)i(s);j()}},i(t){if(!r){for(let t=0;t<n.length;t+=1)R(o[t]);r=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)L(o[t]);r=!1},d(t){h(o,t),t&&u(e)}}}function cn(t){let e,r;return e=new W({props:{letter:t[13],color:"",frozen:t[12]<t[0].length-1}}),e.$on("colorchange",(function(...e){return t[4](t[15],...e)})),{c(){var t;(t=e.$$.fragment)&&t.c()},m(t,n){P(e,t,n),r=!0},p(r,n){t=r;const o={};1&n&&(o.letter=t[13]),1&n&&(o.frozen=t[12]<t[0].length-1),e.$set(o)},i(t){r||(R(e.$$.fragment,t),r=!0)},o(t){L(e.$$.fragment,t),r=!1},d(t){C(e,t)}}}function ln(t){let e,r,n,o,i,g,y,m,b,w=t[10].map(gn),v=[];for(let e=0;e<w.length;e+=1)v[e]=cn(un(t,w,e));const E=t=>L(v[t],1,1,(()=>{v[t]=null}));return{c(){e=f("div"),r=f("div");for(let t=0;t<v.length;t+=1)v[t].c();n=l(),o=f("button"),i=c("Next Word"),g=l(),d(r,"class","word svelte-mfb9xn"),d(o,"class","next svelte-mfb9xn"),o.disabled=t[1],d(e,"class","entry svelte-mfb9xn")},m(u,h){a(u,e,h),s(e,r);for(let t=0;t<v.length;t+=1)v[t].m(r,null);s(e,n),s(e,o),s(o,i),s(e,g),y=!0,m||(b=p(o,"click",t[3]),m=!0)},p(t,e){if(5&e){let n;for(w=t[10].map(gn),n=0;n<w.length;n+=1){const o=un(t,w,n);v[n]?(v[n].p(o,e),R(v[n],1)):(v[n]=cn(o),v[n].c(),R(v[n],1),v[n].m(r,null))}for($(),n=w.length;n<v.length;n+=1)E(n);j()}(!y||2&e)&&(o.disabled=t[1])},i(t){if(!y){for(let t=0;t<w.length;t+=1)R(v[t]);y=!0}},o(t){v=v.filter(Boolean);for(let t=0;t<v.length;t+=1)L(v[t]);y=!1},d(t){t&&u(e),h(v,t),m=!1,b()}}}function pn(e){let r;return{c(){r=f("p"),r.textContent="Setting things up...",d(r,"class","loader svelte-mfb9xn")},m(t,e){a(t,r,e)},p:t,i:t,o:t,d(t){t&&u(r)}}}function dn(t){let e,r,n,o,i={ctx:t,current:null,token:null,hasCatch:!1,pending:pn,then:fn,catch:hn,value:9,blocks:[,,,]};return function(t,e){const r=e.token={};function n(t,n,o,i){if(e.token!==r)return;e.resolved=i;let s=e.ctx;void 0!==o&&(s=s.slice(),s[o]=i);const a=t&&(e.current=t)(s);let u=!1;e.block&&(e.blocks?e.blocks.forEach(((t,r)=>{r!==n&&t&&($(),L(t,1,1,(()=>{e.blocks[r]===t&&(e.blocks[r]=null)})),j())})):e.block.d(1),a.c(),R(a,1),a.m(e.mount(),e.anchor),u=!0),e.block=a,e.blocks&&(e.blocks[n]=a),u&&B()}if((o=t)&&"object"==typeof o&&"function"==typeof o.then){const r=b();if(t.then((t=>{m(r),n(e.then,1,e.value,t),m(null)}),(t=>{if(m(r),n(e.catch,2,e.error,t),m(null),!e.hasCatch)throw t})),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,t),!0;e.resolved=t}var o}(t[3](),i),{c(){e=f("style"),e.textContent="body {\n\t\t\tbackground-color: #121213;\n\t\t}",r=l(),n=f("main"),i.block.c()},m(t,u){s(document.head,e),a(t,r,u),a(t,n,u),i.block.m(n,i.anchor=null),i.mount=()=>n,i.anchor=null,o=!0},p(e,[r]){!function(t,e,r){const n=e.slice(),{resolved:o}=t;t.current===t.then&&(n[t.value]=o),t.current===t.catch&&(n[t.error]=o),t.block.p(n,r)}(i,t=e,r)},i(t){o||(R(i.block),o=!0)},o(t){for(let t=0;t<3;t+=1){L(i.blocks[t])}o=!1},d(t){u(e),t&&u(r),t&&u(n),i.block.d(),i.token=null,i=null}}}Ir=sn;const gn=({letter:t})=>t;function yn(t,e,r){const n=new q,o=new en({id:"wordle-gvqgy"});Fr.anonymous();let i=[],s=!0;function a(t,e){r(0,i[i.length-1][t].color=q.COLOR[e],i),r(1,s=!(0===i[i.length-1].filter((t=>void 0===t.color)).length&&i[i.length-1].filter((t=>t.color===q.COLOR.correct)).length<5))}return[i,s,a,async function(){i.length>0&&n.pushRow(i[i.length-1]);const t=n.agg(),e=o.currentUser.mongoClient("mongodb-atlas").db("wordle_solver").collection("dictionary"),[{word:s}]=await e.aggregate(t);return r(0,i=[...i,s.split("").map((t=>({letter:t})))]),i},(t,e)=>a(t,e.detail.color)]}return new class extends J{constructor(t){super(),M(this,t,yn,dn,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
